(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.BaseGraph=function(){function e(e,i){return this.setYAxisPosition=t(this.setYAxisPosition,this),this.setXAxisPosition=t(this.setXAxisPosition,this),this.onResize=t(this.onResize,this),this.setupMarkerLabel=t(this.setupMarkerLabel,this),this.setupMarkerLine=t(this.setupMarkerLine,this),this.id=e,this.options=$.extend(!0,{},n,i),this.$el=$("#"+this.id),this.getDimensions(),this.setSVG(),this.setScales(),this.markers=[],this}var i,n;return n={margin:{top:0,right:0,bottom:20,left:0},aspectRatio:.5625,label:!1,legend:!1,mouseEvents:!0,key:{id:"key",x:"key",y:"value"}},i={value:null,label:"",orientation:"horizontal",align:"right"},e.prototype.setSVG=function(){return this.svg=d3.select("#"+this.id).append("svg").attr("width",this.containerWidth).attr("height",this.containerHeight),this.container=this.svg.append("g").attr("transform","translate("+this.options.margin.left+","+this.options.margin.top+")")},e.prototype.loadData=function(t){return d3.csv(t,function(t){return function(e,i){return t.$el.trigger("data-loaded"),t.setData(i)}}(this)),this},e.prototype.setData=function(t){return this.data=this.dataParser(t),this.drawScales(),this.options.legend&&this.drawLegend(),this.drawMarkers(),this.drawGraph(),this.$el.trigger("draw-complete"),this},e.prototype.dataParser=function(t){return t},e.prototype.setGraph=function(){return this},e.prototype.setScales=function(){return this},e.prototype.drawScales=function(){return this.x.domain(this.getScaleXDomain()),this.y.domain(this.getScaleYDomain()),this.xAxis&&this.container.append("g").attr("class","x axis").call(this.setXAxisPosition).call(this.xAxis),this.yAxis&&this.container.append("g").attr("class","y axis").call(this.setYAxisPosition).call(this.yAxis),this},e.prototype.getScaleXRange=function(){return[0,this.width]},e.prototype.getScaleYRange=function(){return[this.height,0]},e.prototype.getScaleXDomain=function(){return[]},e.prototype.getScaleYDomain=function(){return[]},e.prototype.drawLegend=function(){return this},e.prototype.addMarker=function(t){return this.markers.push($.extend({},i,t)),this},e.prototype.drawMarkers=function(){return this.container.selectAll(".marker").data(this.markers).enter().append("line").attr("class","marker").call(this.setupMarkerLine),this.container.selectAll(".marker-label").data(this.markers).enter().append("text").attr("class","marker-label").attr("text-anchor",function(t){return"vertical"===t.orientation?"middle":"right"===t.align?"end":"start"}).attr("dy",function(t){return"horizontal"===t.orientation?"-0.25em":0}).text(function(t){return t.label}).call(this.setupMarkerLabel)},e.prototype.setupMarkerLine=function(t){return t.attr("x1",function(t){return function(e){return"horizontal"===e.orientation?0:t.x(e.value)}}(this)).attr("y1",function(t){return function(e){return"horizontal"===e.orientation?t.y(e.value):0}}(this)).attr("x2",function(t){return function(e){return"horizontal"===e.orientation?t.width:t.x(e.value)}}(this)).attr("y2",function(t){return function(e){return"horizontal"===e.orientation?t.y(e.value):t.height}}(this))},e.prototype.setupMarkerLabel=function(t){return t.attr("x",function(t){return function(e){return"horizontal"===e.orientation?"right"===e.align?t.width:0:t.x(e.value)}}(this)).attr("y",function(t){return function(e){return"horizontal"===e.orientation?t.y(e.value):t.height}}(this))},e.prototype.onResize=function(){return this.getDimensions(),this.updateGraphDimensions(),this},e.prototype.getDimensions=function(){return this.$el&&(this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth*this.options.aspectRatio,this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},e.prototype.updateGraphDimensions=function(){return this.svg&&this.svg.attr("width",this.containerWidth).attr("height",this.containerHeight),this.x&&this.x.range(this.getScaleXRange()),this.y&&this.y.range(this.getScaleYRange()),this.xAxis&&this.container.selectAll(".x.axis").call(this.setXAxisPosition).call(this.xAxis),this.yAxis&&this.container.selectAll(".y.axis").call(this.setYAxisPosition).call(this.yAxis),this.container.select(".marker").call(this.setupMarkerLine),this.container.select(".marker-label").call(this.setupMarkerLabel),this},e.prototype.setXAxisPosition=function(t){return t.attr("transform","translate(0,"+this.height+")")},e.prototype.setYAxisPosition=function(t){return t.attr("transform","translate("+this.width+",0)")},e.prototype.getDataX=function(){return d[this.options.key.x]},e.prototype.getDataY=function(){return d[this.options.key.y]},e}()}).call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.BarHorizontalGraph=function(i){function n(e,i){return this.setBars=t(this.setBars,this),n.__super__.constructor.call(this,e,i),this}return e(n,i),n.prototype.setSVG=function(){return this.container=d3.select("#"+this.id).attr("class","bar-horizontal-graph")},n.prototype.dataParser=function(t){return t.forEach(function(t){return function(e){return e[t.options.key.x]=+e[t.options.key.x]}}(this)),t},n.prototype.setScales=function(){return this},n.prototype.drawScales=function(){return this},n.prototype.drawGraph=function(){return this.container.selectAll(".bar").data(this.data).enter().append("div").call(this.setBars),this},n.prototype.setBars=function(t){return this.options.key.id&&(t.attr("id",function(t){return function(e){return e[t.options.key.id]}}(this)),t.append("div").attr("class","bar-title").html(function(t){return function(e){return e[t.options.key.id]}}(this))),t.append("div").attr("class","bar").style("width",function(t){return function(e){return e[t.options.key.x]+"%"}}(this)).append("span").html(function(t){return function(e){return Math.round(e[t.options.key.x])+"%"}}(this))},n}(window.BaseGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.MapGraph=function(i){function n(e,i){return this.setTooltipData=t(this.setTooltipData,this),this.onMouseOut=t(this.onMouseOut,this),this.onMouseMove=t(this.onMouseMove,this),this.onMouseOver=t(this.onMouseOver,this),this.getLegendData=t(this.getLegendData,this),this.setLegendPosition=t(this.setLegendPosition,this),this.setCountryColor=t(this.setCountryColor,this),n.__super__.constructor.call(this,e,i),this.formatFloat=d3.format(",.1f"),this.formatInteger=d3.format(",d"),this}return e(n,i),n.prototype.setSVG=function(){return n.__super__.setSVG.call(this),this.$tooltip=this.$el.find(".tooltip")},n.prototype.setScales=function(){return this.color=d3.scaleSequential(d3.interpolateOranges),this},n.prototype.loadData=function(t,e){return d3.queue().defer(d3.csv,t).defer(d3.json,e).await(function(t){return function(e,i,n){return t.$el.trigger("data-loaded"),t.setData(i,n)}}(this)),this},n.prototype.setData=function(t,e){return this.data=this.dataParser(t),this.setColorDomain(),this.options.legend&&this.drawLegend(),this.drawGraph(e),this},n.prototype.setColorDomain=function(){return this.color.domain([0,d3.max(this.data,function(t){return t.value})]),this},n.prototype.drawLegend=function(){var t,e;return t=30,e=this.getLegendData(),this.legend=this.container.append("g").attr("class","legend").call(this.setLegendPosition),this.legend.selectAll("rect").data(e).enter().append("rect").attr("x",function(i,n){return Math.round(t*(n-e.length/2))}).attr("width",t).attr("height",8).attr("fill",function(t){return function(e){return t.color(e)}}(this)),e.shift(),this.legend.selectAll("text").data(e).enter().append("text").attr("x",function(i,n){return Math.round(t*(n+.5-e.length/2))}).attr("y",20).attr("text-anchor","start").text(function(t){return t})},n.prototype.drawGraph=function(t){return this.countries=topojson.feature(t,t.objects.countries),this.countries.features=this.countries.features.filter(function(t){return"010"!==t.id}),this.projection=d3.geoKavrayskiy7(),this.projectionSetSize(),this.path=d3.geoPath().projection(this.projection),this.container.selectAll(".country").data(this.countries.features).enter().append("path").attr("id",function(t){return"country-"+t.id}).attr("class",function(t){return"country"}).attr("fill",this.setCountryColor).attr("stroke-width",1).attr("stroke",this.setCountryColor).attr("d",this.path),this.$tooltip&&this.container.selectAll(".country").on("mouseover",this.onMouseOver).on("mousemove",this.onMouseMove).on("mouseout",this.onMouseOut),this.$el.trigger("draw-complete"),this},n.prototype.updateGraph=function(t){return this.data=this.dataParser(t),this.setColorDomain(),this.container.selectAll(".country").transition().attr("fill",this.setCountryColor).attr("stroke",this.setCountryColor)},n.prototype.updateGraphDimensions=function(){return n.__super__.updateGraphDimensions.call(this),this.projectionSetSize(),this.path.projection(this.projection),this.container.selectAll(".country").attr("d",this.path),this.options.legend&&this.legend.call(this.setLegendPosition),this},n.prototype.projectionSetSize=function(){return this.projection.fitSize([this.width,this.height],this.countries).scale(1.1*this.projection.scale()).translate([.48*this.width,.6*this.height])},n.prototype.setCountryColor=function(t){var e;return e=this.data.filter(function(e){return e.code_num===t.id}),e[0]?this.color(e[0].value):"#eee"},n.prototype.setLegendPosition=function(t){return t.attr("transform","translate("+Math.round(.5*this.width)+","+-this.options.margin.top+")")},n.prototype.getLegendData=function(){return d3.range(0,this.color.domain()[1])},n.prototype.onMouseOver=function(t){var e,i,n;if(n=this.data.filter(function(e){return e.code_num===t.id}),n.length>0)return i=d3.mouse(d3.event.target),this.setTooltipData(n[0]),e=$(d3.event.target).offset(),this.$tooltip.css({left:i[0]-.5*this.$tooltip.width(),top:i[1]-.5*this.$tooltip.height(),opacity:"1"})},n.prototype.onMouseMove=function(t){var e;return e=d3.mouse(d3.event.target),this.$tooltip.css({left:e[0]-.5*this.$tooltip.width(),top:e[1]-.5*this.$tooltip.height()})},n.prototype.onMouseOut=function(t){return this.$tooltip.css("opacity","0")},n.prototype.setTooltipData=function(t){if(this.$tooltip.find(".tooltip-inner .title").html(t.name),this.$tooltip.find(".tooltip-inner .value").html(this.formatFloat(t.value)),t.cases)return this.$tooltip.find(".tooltip-inner .cases").html(this.formatInteger(t.cases))},n}(window.BaseGraph)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;window.ContraceptivesUseMapGraph=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var n;return t(i,e),n=0,i.prototype.getDimensions=function(){var t;return this.$el&&(t=$("body").height(),this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth*this.options.aspectRatio,this.containerHeight>t?(this.containerHeight=t,this.containerWidth=this.containerHeight/this.options.aspectRatio,this.$el.css("top",0)):this.$el.css("top",(t-this.containerHeight)/2),this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},i.prototype.setColorDomain=function(){return this.color.domain([0,80]),this},i.prototype.setMapState=function(t){if(t!==this.currentState)return this.currentState=t,1===t?this.data.forEach(function(t){return t.value=+t["Female sterilization"]}):2===t?this.data.forEach(function(t){return t.value=+t.IUD}):3===t?this.data.forEach(function(t){return t.value=+t.Pill}):4===t?this.data.forEach(function(t){return t.value=+t["Male condom"]}):5===t?this.data.forEach(function(t){return t.value=+t.Injectable}):6===t&&this.data.forEach(function(t){return t.value=+t["Any traditional method"]}),this.updateGraph(this.data)},i}(window.MapGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.TreemapGraph=function(i){function n(e,i){return this.isNodeLabelVisible=t(this.isNodeLabelVisible,this),this.setNodeLabel=t(this.setNodeLabel,this),this.setNode=t(this.setNode,this),i.minSize=i.minSize||80,i.nodesPadding=i.nodesPadding||8,i.transitionDuration=i.transitionDuration||600,i.mobileBreakpoint=i.mobileBreakpoint||620,n.__super__.constructor.call(this,e,i),this}return e(n,i),n.prototype.drawScales=function(){return this},n.prototype.setSVG=function(){return this.container=d3.select("#"+this.id).append("div").attr("class","nodes-container").style("height",this.height+"px")},n.prototype.drawGraph=function(){return this.treemap=d3.treemap().size([this.width,this.height]).padding(0).round(!0),this.width<=this.options.mobileBreakpoint&&this.treemap.tile(d3.treemapSlice),this.stratify=d3.stratify().parentId(function(t){return t.parent}),this.treemapRoot=this.stratify(this.data).sum(function(t){return function(e){return e[t.options.key.value]}}(this)).sort(function(t,e){return e.value-t.value}),this.treemap(this.treemapRoot),this.nodes=this.container.selectAll(".node").data(this.treemapRoot.leaves()).enter().append("div").call(this.setNode).call(this.setNodeDimension),this.drawGraphLabels(),this},n.prototype.updateGraph=function(){return this.treemapRoot=this.stratify(this.data).sum(function(t){return function(e){return e[t.options.key.value]}}(this)).sort(function(t,e){return e.value-t.value}),this.treemap(this.treemapRoot),this.nodes.selectAll(".node-label").remove(),this.nodes.data(this.treemapRoot.leaves()).call(this.setNode).transition().duration(this.options.transitionDuration).on("end",function(t){return function(e,i){if(i===t.nodes.size()-1)return t.drawGraphLabels()}}(this)).call(this.setNodeDimension),this},n.prototype.drawGraphLabels=function(){return this.nodes.append("div").attr("class","node-label").style("visibility","hidden").call(this.setNodeLabel),this.nodes.filter(this.isNodeLabelVisible).selectAll(".node-label").style("visibility","visible")},n.prototype.getDimensions=function(){return n.__super__.getDimensions.call(this),this.width<=this.options.mobileBreakpoint&&(this.containerHeight=this.containerWidth,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},n.prototype.updateGraphDimensions=function(){return n.__super__.updateGraphDimensions.call(this),this.container.style("height",this.height+"px"),this.width<=this.options.mobileBreakpoint?this.treemap.tile(d3.treemapSlice):this.treemap.tile(d3.treemapSquarify),this.treemap.size([this.width,this.height]),this.treemap(this.treemapRoot),this.nodes.data(this.treemapRoot.leaves()),this.nodes.call(this.setNode).call(this.setNodeDimension).filter(this.isNodeLabelVisible).selectAll(".node-label").style("visibility","visible"),this},n.prototype.getNodeClass=function(t){return"node"},n.prototype.setNode=function(t){return t.attr("class",this.getNodeClass).style("padding",function(t){return function(e){return e.x1-e.x0>2*t.options.nodesPadding&&e.y1-e.y0>2*t.options.nodesPadding?t.options.nodesPadding+"px":0}}(this)).style("visibility",function(t){return t.x1-t.x0===0||t.y1-t.y0===0?"hidden":""})},n.prototype.setNodeLabel=function(t){var e;return e=t.append("div").attr("class","node-label-content"),e.append("p").attr("class",function(t){return t.value>25?"size-l":t.value<10?"size-s":""}).html(function(t){return function(e){return e.data[t.options.key.id]}}(this))},n.prototype.setNodeDimension=function(t){return t.style("left",function(t){return t.x0+"px"}).style("top",function(t){return t.y0+"px"}).style("width",function(t){return t.x1-t.x0+"px"}).style("height",function(t){return t.y1-t.y0+"px"})},n.prototype.isNodeLabelVisible=function(t){return t.x1-t.x0>this.options.minSize&&t.y1-t.y0>this.options.minSize},n}(window.BaseGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.ContraceptivesUseTreemapGraph=function(i){function n(){return this.onResize=t(this.onResize,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.dataParser=function(t,e,i){var n,o,r,s,a;n=t.filter(function(t){return t.code===e}),$("#treemap-contraceptives-use-country").html(i),s={},this.options.methodsKeys.forEach(function(t){return function(e,i){return n[0][e]?s[e]={id:e.toLowerCase().replace(/ /g,"-").replace(")","").replace("(",""),name:t.options.methodsNames[i],value:+n[0][e]}:void 0}}(this));for(o in s)r=s[o],"Other modern methods"!==o&&"Any traditional method"!==o&&r.value<5&&(s["Other modern methods"].value+=r.value,delete s[o]);a=[{id:"r"}];for(o in s)r=s[o],a.push({id:r.id,name:"<strong>"+r.name+"</strong><br/>"+Math.round(r.value)+"%",value:r.value,parent:"r"});return a},n.prototype.setData=function(t,e,i){return this.originalData=t,this.data=this.dataParser(this.originalData,e,i),this.drawGraph(),this.setContainerOffset(),this.$el.trigger("draw-complete"),this},n.prototype.updateData=function(t,e){return this.data=this.dataParser(this.originalData,t,e),this.updateGraph(),this},n.prototype.onResize=function(){return n.__super__.onResize.call(this),this.setContainerOffset(),this},n.prototype.getNodeClass=function(t){return"node node-"+t.id},n.prototype.setContainerOffset=function(){return this.$el.css("top",.5*($(window).height()-this.$el.height()))},n}(window.TreemapGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.BeeswarmScatterplotGraph=function(i){function n(e,i){return this.getColorDomain=t(this.getColorDomain,this),this.getSizeDomain=t(this.getSizeDomain,this),this.getSizeRange=t(this.getSizeRange,this),this.getScaleYDomain=t(this.getScaleYDomain,this),this.getScaleXDomain=t(this.getScaleXDomain,this),this.setScatterplot=t(this.setScatterplot,this),this.setScatterplotDotPosition=t(this.setScatterplotDotPosition,this),this.setDotPosition=t(this.setDotPosition,this),this.setDot=t(this.setDot,this),i.dotSize=i.dotSize||5,i.dotMinSize=i.dotMinSize||2,i.dotMaxSize=i.dotMaxSize||15,n.__super__.constructor.call(this,e,i),this}return e(n,i),n.prototype.drawGraph=function(){return this.setSize(),this.setSimulation(),this.runSimulation(),this.container.selectAll(".dot").data(this.data).enter().append("circle").attr("class","dot").attr("id",function(t){return function(e){return"dot-"+e[t.options.key.id]}}(this)).call(this.setDot).on("mouseover",function(t){return function(t){}}(this))},n.prototype.setDot=function(t){return t.attr("r",function(t){return function(e){return t.size?e.radius:t.options.dotSize}}(this)).call(this.setDotPosition)},n.prototype.setSimulation=function(){var t;return t=d3.forceY(function(t){return function(e){return t.y(e[t.options.key.y])}}(this)),t.strength(1),this.simulation=d3.forceSimulation(this.data).force("x",t).force("y",d3.forceX(.5*this.width)).force("collide",d3.forceCollide(function(t){return function(e){return t.size?e.radius+1:t.options.dotSize+1}}(this))).stop()},n.prototype.runSimulation=function(){var t,e;for(t=0,e=[];t<350;)this.simulation.tick(),e.push(++t);return e},n.prototype.setDotPosition=function(t){return t.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})},n.prototype.setScatterplotDotPosition=function(t){return t.attr("cx",function(t){return function(e){return t.x(e[t.options.key.x])}}(this)).attr("cy",function(t){return function(e){return t.y(e[t.options.key.y])}}(this))},n.prototype.setSize=function(){if(this.size)return this.data.forEach(function(t){return function(e){return e.radius=t.size(e[t.options.key.size])}}(this))},n.prototype.updateGraphDimensions=function(){return this.xAxis.tickSize(this.height),this.yAxis.tickSize(this.width),n.__super__.updateGraphDimensions.call(this),this.setSimulation(),this.runSimulation(),this.container.selectAll(".dot").call(this.setDotPosition),this},n.prototype.setScatterplot=function(){return this.container.selectAll(".dot").call(this.setScatterplotDotPosition)},n.prototype.setScales=function(){return this.x=d3.scalePow().exponent(.125).range(this.getScaleXRange()),this.y=d3.scaleLinear().range(this.getScaleYRange()),this.options.key.size&&(this.size=d3.scalePow().exponent(.5).range(this.getSizeRange())),this.options.key.color&&(this.colorMap=d3.scaleQuantize().domain([0,100]).range([25,50,75,100]),this.color=d3.scaleSequential(d3.interpolateRdYlGn)),this.xAxis=d3.axisBottom(this.x).tickSize(this.height),this.yAxis=d3.axisLeft(this.y).tickSize(this.width),this},n.prototype.getScaleXDomain=function(){return[200,85e3]},n.prototype.getScaleYDomain=function(){return[0,d3.max(this.data,function(t){return function(e){return e[t.options.key.y]}}(this))]},n.prototype.getSizeRange=function(){return[this.options.dotMinSize,this.options.dotMaxSize]},n.prototype.getSizeDomain=function(){return[0,d3.max(this.data,function(t){return function(e){return e[t.options.key.size]}}(this))]},n.prototype.getColorDomain=function(){return[100,0]},n.prototype.drawScales=function(){return this.x.domain(this.getScaleXDomain()),this.y.domain(this.getScaleYDomain()),this.size&&this.size.domain(this.getSizeDomain()),this.color&&this.color.domain(this.getColorDomain()),this},n.prototype.getDimensions=function(){return this.$el&&(this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth*this.options.aspectRatio,this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},n}(window.BaseGraph)}.call(this),function(){!function(t){var e,i,n,o,r,s,a,h,u,c,l,p,d,f,m,y,g,v,w;return v=null,g=null,y=null,m=null,w={},a=!1,i=t("body").data("lang"),e=t("body").data("baseurl"),"es"===i&&d3.formatDefaultLocale({currency:["$",""],decimal:",",thousands:".",grouping:[3]}),o=["Female sterilization","Male sterilization","IUD","Implant","Injectable","Pill","Male condom","Female condom","Vaginal barrier methods","Lactational amenorrhea method (LAM)","Emergency contraception","Other modern methods","Any traditional method"],r={es:["Esterilización femenina","Esterilización masculina","DIU","Implante","Inyectable","Píldora","Condón masculino","Condón femenino","Métodos de barrera vaginal","Método de la amenorrea de la lactancia (MELA)","Anticonceptivos de emergencia","Otros métodos modernos","Métodos tradicionales"],en:["Female sterilization","Male sterilization","IUD","Implant","Injectable","Pill","Male condom","Female condom","Vaginal barrier methods","Lactational amenorrhea method (LAM)","Emergency contraception","Other modern methods","Traditional methods"]},n={"Female sterilization":"sterilization","Male sterilization":"sterilization",IUD:"diu",Implant:null,Injectable:"injectable",Pill:"pill","Male condom":"condom","Female condom":null,"Vaginal barrier methods":null,"Lactational amenorrhea method (LAM)":null,"Emergency contraception":null,"Other modern methods":null,"Any traditional method":"traditional"},s={a:"not married",b:"not having sex",c:"infrequent sex",d:"menopausal/hysterectomy",e:"subfecund/infecund",f:"postpartum amenorrheic",g:"breastfeeding",h:"fatalistic",i:"respondent opposed",j:"husband/partner opposed",k:"others opposed",l:"religious prohibition",m:"knows no method",n:"knows no source",o:"health concerns",p:"fear of side effects/health concerns",q:"lack of access/too far",r:"costs too much",s:"inconvenient to use",t:"interferes with bodys processes",u:"preferred method not available",v:"no method available",w:"(no estándar)",x:"other",z:"don't know"},d=function(e){var i,n,o,r,s,h,u,c,l,p;return n=d3.select("#"+e),o=n.select(".scroll-graphic"),i=o.select(".graph-container"),p=n.select(".scroll-text"),l=p.selectAll(".step"),c=scrollama(),h=function(){var t,e;return e=Math.floor(window.innerWidth),t=Math.floor(window.innerHeight),l.style("height",t+"px"),o.style("height",t+"px"),i.style("width",e+"px").style("height",t+"px"),c.resize()},r=function(t){return o.classed("is-fixed",!0).classed("is-bottom",!1)},s=function(t){return o.classed("is-fixed",!1).classed("is-bottom","down"===t.direction)},u=function(e){var i,n,o,r,s,a;if(i=t(e.element),r=i.data("instance"),s=i.data("step"),0===r){if(v){if(1===s)return v.updateData("world","Mundo");if(0===s&&"up"===e.direction)return v.updateData(w.code,w.name)}}else if(1===r){if(g)return g.setMapState(s)}else if(2===r){if(y&&s>0)return n=[63,88,100],o=s>1?n[s-2]:0,a=n[s-1],void y.selectAll("li").filter(function(t){return t>=o&&t<a}).classed("fill-"+s,"down"===e.direction)}else if(3===r&&m&&s>0)return m.setScatterplot()},h(),c.setup({container:"#"+e,graphic:".scroll-graphic",text:".scroll-text",step:".scroll-text .step",offset:.8}).onContainerEnter(r).onContainerExit(s),a||(a=!0,c.onStepEnter(u)),window.addEventListener("resize",h)},u=function(){var e,i,n,o,r;return d("contraceptives-use-graph-container"),i=0,y=d3.select("#contraceptives-use-graph"),e=function(){for(r=[],n=0;n<=99;n++)r.push(n);return r}.apply(this),y.append("ul").selectAll("li").data(e).enter().append("li").append("svg").append("use").attr("xlink:href","#icon-woman").attr("viewBox","0 0 193 450"),o=function(){var e,n;return i!==y.node().offsetWidth&&(i=y.node().offsetWidth,n=i/20-10,e=2.33*n,y.selectAll("li").style("width",n+"px").style("height",e+"px"),y.selectAll("svg").attr("width",n).attr("height",e)),y.style("margin-top",.5*(t("body").height()-y.node().offsetHeight)+"px")},window.addEventListener("resize",o),o()},f=function(e,i,n){var o;return d("unmet-needs-gdp-container-graph"),o=[],e.forEach(function(t){var e,r;return e=i.filter(function(e){return e.code===t.code}),r=n.filter(function(e){return e.code===t.code}),e[0]&&e[0][2016]?o.push({value:+t[2017],name:e[0].name,region:e[0].region,population:r[0][2015],gni:e[0][2016]}):void 0}),m=new window.BeeswarmScatterplotGraph("unmet-needs-gdp-graph",{margin:{left:0,rigth:0,top:0,bottom:0},key:{x:"gni",y:"value",id:"name",size:"population"},dotMinSize:1,dotMaxSize:12}),m.setData(o),t(window).resize(m.onResize)},h=function(e,n,s){return d("contraceptives-use-container"),e.forEach(function(t){var e;return e=n.filter(function(e){return e.code===t.code}),t.values=[],t.value=0,o.forEach(function(e,n){return t.values.push({id:n,name:r[i][n],value:""!==t[e]?+t[e]:null})}),e&&e[0]?(t.name=e[0]["name_"+i],t.code_num=e[0].code_num):void 0}),g=new window.ContraceptivesUseMapGraph("map-contraceptives-use",{aspectRatio:.5625,margin:{top:0,bottom:0},legend:!1}),g.setData(e,s),g.onResize(),t(window).resize(g.onResize)},p=function(t,e){var i,n,o,r,a,h,u,c;return i=[],n=[],o=[],h=[],r=[],a=[],u=Object.keys(s),t.forEach(function(t){return i.push({name:t.name,value:t.o+t.p+t.t}),n.push({name:t.name,value:t.b}),o.push({name:t.name,value:t.i+t.j+t.k+t.l}),h.push({name:t.name,value:t.i}),r.push({name:t.name,value:t.j}),a.push({name:t.name,value:t.l})}),c=function(t,e){return e.value-t.value},i.sort(c),n.sort(c),o.sort(c),h.sort(c),r.sort(c),a.sort(c),new window.BarHorizontalGraph("contraceptives-reasons-health",{key:{id:"name",x:"value"}}).setData(i.slice(0,5)),new window.BarHorizontalGraph("contraceptives-reasons-opposed",{key:{id:"name",x:"value"}}).setData(o.slice(0,5)),new window.BarHorizontalGraph("contraceptives-reasons-not-sex",{key:{id:"name",x:"value"}}).setData(n.slice(0,5)),new window.BarHorizontalGraph("contraceptives-reasons-opposed-respondent",{key:{id:"name",x:"value"}}).setData(h.slice(0,5)),new window.BarHorizontalGraph("contraceptives-reasons-opposed-husband",{key:{id:"name",x:"value"}}).setData(r.slice(0,5)),new window.BarHorizontalGraph("contraceptives-reasons-opposed-religious",{key:{id:"name",x:"value"}}).setData(a.slice(0,5))},c=function(e){return d("treemap-contraceptives-use-container"),v=new window.ContraceptivesUseTreemapGraph("treemap-contraceptives-use",{aspectRatio:.5625,margin:{left:0,rigth:0,top:0,bottom:0},key:{value:"value",id:"name"},methodsKeys:o,methodsNames:r[i]}),v.setData(e,w.code,w.name),t(window).resize(v.onResize)},l=function(e,n,a){return t("#contraceptives-app .select-country").change(function(){var h,u,c,l,p,d;return h=t(this).val(),p=e.filter(function(t){return t.code===h}),p&&p[0]?(u=o.map(function(t,e){return{name:r[i][e],value:+p[0][t]}}),u=u.sort(function(t,e){return e.value-t.value}),t("#contraceptives-app-data-use").html(Math.round(+p[0]["Any modern method"])+"%"),t("#contraceptives-app-data-main-method").html(u[0].name),t("#contraceptives-app-data-main-method-value").html(Math.round(u[0].value)+"%"),t("#contraceptives-app-use").show()):t("#contraceptives-app-use").hide(),l=n.filter(function(t){return t.code===h}),l&&l[0]?(t("#contraceptives-app-data-unmetneeds").html(Math.round(+l[0][2017])+"%"),t("#contraceptives-app-unmetneeds").show()):t("#contraceptives-app-unmetneeds").hide(),c=a.filter(function(t){return t.code===h}),c&&c[0]?(d=Object.keys(s).map(function(t){return{name:s[t],value:+c[0][t]}}),d=d.sort(function(t,e){return e.value-t.value}),t("#contraceptives-app-data-reason").html(d[0].name),t("#contraceptives-app-data-reason-value").html(Math.round(d[0].value)+"%"),t("#contraceptives-app-reason").show()):t("#contraceptives-app-reason").hide()}).val(w.code).trigger("change")},t("#contraceptives-use-graph").length>0&&u(),d3.queue().defer(d3.csv,e+"/data/contraceptives-use-countries.csv").defer(d3.csv,e+"/data/unmet-needs.csv").defer(d3.csv,e+"/data/contraceptives-reasons.csv").defer(d3.csv,e+"/data/countries.csv").defer(d3.csv,e+"/data/countries-gni-"+i+".csv").defer(d3.csv,e+"/data/countries-population-"+i+".csv").defer(d3.json,e+"/data/map-world-110.json").defer(d3.json,"https://freegeoip.net/json/").await(function(e,n,o,r,a,u,d,m,y){var g;if(y?(g=a.filter(function(t){return t.code2===y.country_code}),g[0]&&(w.code=g[0].code,w.name=g[0]["name_"+i])):y={},y.code||(w.code="ESP",w.name="es"===i?"España":"Spain"),r.forEach(function(t){var e;return e=a.filter(function(e){return e.code2===t.code}),e&&e[0]?(t.code=e[0].code,t.name=e[0]["name_"+i],Object.keys(s).forEach(function(e){t[e]=100*t[e],t[e]>100}),delete t.country):void 0}),t("#treemap-contraceptives-use").length&&c(n),t("#map-contraceptives-use").length&&h(n,a,m),t("#unmet-needs-gdp-graph").length&&f(o,u,d),t("#contraceptives-reasons-opposed").length&&p(r,a),t("#contraceptives-app").length)return l(n,o,r)})}(jQuery)}.call(this);