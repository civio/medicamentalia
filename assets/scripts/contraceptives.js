(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.BaseGraph=function(){function e(e,n){return this.setYAxisPosition=t(this.setYAxisPosition,this),this.setXAxisPosition=t(this.setXAxisPosition,this),this.onResize=t(this.onResize,this),this.setupMarkerLabel=t(this.setupMarkerLabel,this),this.setupMarkerLine=t(this.setupMarkerLine,this),this.id=e,this.options=$.extend(!0,{},i,n),this.$el=$("#"+this.id),this.getDimensions(),this.setSVG(),this.setScales(),this.markers=[],this}var n,i;return i={margin:{top:0,right:0,bottom:20,left:0},aspectRatio:.5625,label:!1,legend:!1,mouseEvents:!0,key:{id:"key",x:"key",y:"value"}},n={value:null,label:"",orientation:"horizontal",align:"right"},e.prototype.setSVG=function(){return this.svg=d3.select("#"+this.id).append("svg").attr("width",this.containerWidth).attr("height",this.containerHeight),this.container=this.svg.append("g").attr("transform","translate("+this.options.margin.left+","+this.options.margin.top+")")},e.prototype.loadData=function(t){return d3.csv(t,function(t){return function(e,n){return t.$el.trigger("data-loaded"),t.setData(n)}}(this)),this},e.prototype.setData=function(t){return this.data=this.dataParser(t),this.drawScales(),this.options.legend&&this.drawLegend(),this.drawMarkers(),this.drawGraph(),this.$el.trigger("draw-complete"),this},e.prototype.dataParser=function(t){return t},e.prototype.setGraph=function(){return this},e.prototype.setScales=function(){return this},e.prototype.drawScales=function(){return this.x.domain(this.getScaleXDomain()),this.y.domain(this.getScaleYDomain()),this.xAxis&&this.container.append("g").attr("class","x axis").call(this.setXAxisPosition).call(this.xAxis),this.yAxis&&this.container.append("g").attr("class","y axis").call(this.setYAxisPosition).call(this.yAxis),this},e.prototype.getScaleXRange=function(){return[0,this.width]},e.prototype.getScaleYRange=function(){return[this.height,0]},e.prototype.getScaleXDomain=function(){return[]},e.prototype.getScaleYDomain=function(){return[]},e.prototype.drawLegend=function(){return this},e.prototype.addMarker=function(t){return this.markers.push($.extend({},n,t)),this},e.prototype.drawMarkers=function(){return this.container.selectAll(".marker").data(this.markers).enter().append("line").attr("class","marker").call(this.setupMarkerLine),this.container.selectAll(".marker-label").data(this.markers).enter().append("text").attr("class","marker-label").attr("text-anchor",function(t){return"vertical"===t.orientation?"middle":"right"===t.align?"end":"start"}).attr("dy",function(t){return"horizontal"===t.orientation?"-0.25em":0}).text(function(t){return t.label}).call(this.setupMarkerLabel)},e.prototype.setupMarkerLine=function(t){return t.attr("x1",function(t){return function(e){return"horizontal"===e.orientation?0:t.x(e.value)}}(this)).attr("y1",function(t){return function(e){return"horizontal"===e.orientation?t.y(e.value):0}}(this)).attr("x2",function(t){return function(e){return"horizontal"===e.orientation?t.width:t.x(e.value)}}(this)).attr("y2",function(t){return function(e){return"horizontal"===e.orientation?t.y(e.value):t.height}}(this))},e.prototype.setupMarkerLabel=function(t){return t.attr("x",function(t){return function(e){return"horizontal"===e.orientation?"right"===e.align?t.width:0:t.x(e.value)}}(this)).attr("y",function(t){return function(e){return"horizontal"===e.orientation?t.y(e.value):t.height}}(this))},e.prototype.onResize=function(){return this.getDimensions(),this.updateGraphDimensions(),this},e.prototype.getDimensions=function(){return this.$el&&(this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth*this.options.aspectRatio,this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},e.prototype.updateGraphDimensions=function(){return this.svg&&this.svg.attr("width",this.containerWidth).attr("height",this.containerHeight),this.x&&this.x.range(this.getScaleXRange()),this.y&&this.y.range(this.getScaleYRange()),this.xAxis&&this.container.selectAll(".x.axis").call(this.setXAxisPosition).call(this.xAxis),this.yAxis&&this.container.selectAll(".y.axis").call(this.setYAxisPosition).call(this.yAxis),this.container.select(".marker").call(this.setupMarkerLine),this.container.select(".marker-label").call(this.setupMarkerLabel),this},e.prototype.setXAxisPosition=function(t){return t.attr("transform","translate(0,"+this.height+")")},e.prototype.setYAxisPosition=function(t){return t.attr("transform","translate("+this.width+",0)")},e.prototype.getDataX=function(){return d[this.options.key.x]},e.prototype.getDataY=function(){return d[this.options.key.y]},e}()}).call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.ScrollGraph=function(){function e(e,n){return this.onStepEnter=t(this.onStepEnter,this),this.onContainerExit=t(this.onContainerExit,this),this.onContainerEnter=t(this.onContainerEnter,this),this.onResize=t(this.onResize,this),this.id=e,this.stepCallback=n,this.container=d3.select("#"+this.id),this.graphic=this.container.select(".scroll-graphic"),this.steps=this.container.selectAll(".scroll-text .step"),this.chart=this.graphic.select(".graph-container"),this.scroller=scrollama(),this.onResize(),this.scroller.setup({container:"#"+this.id,graphic:"#"+this.id+" .scroll-graphic",step:"#"+this.id+" .scroll-text .step",offset:.05,debug:!1}).onContainerEnter(this.onContainerEnter).onContainerExit(this.onContainerExit).onStepEnter(this.onStepEnter),window.addEventListener("resize",this.onResize),this}return e.prototype.onResize=function(){var t,e;return e=this.graphic.node().getBoundingClientRect().width,t=Math.floor(window.innerHeight),this.steps.style("height",t+"px"),this.graphic.style("height",t+"px"),this.chart.style("width",e+"px").style("height",t+"px"),this.scroller.resize()},e.prototype.onContainerEnter=function(t){return this.graphic.classed("is-fixed",!0).classed("is-bottom",!1)},e.prototype.onContainerExit=function(t){return this.graphic.classed("is-fixed",!1).classed("is-bottom","down"===t.direction)},e.prototype.onStepEnter=function(t){return this.stepCallback(t)},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;window.MapGraph=function(n){function i(e,n){return this.setTooltipData=t(this.setTooltipData,this),this.onMouseOut=t(this.onMouseOut,this),this.onMouseMove=t(this.onMouseMove,this),this.onMouseOver=t(this.onMouseOver,this),this.getLegendFormat=t(this.getLegendFormat,this),this.getLegendData=t(this.getLegendData,this),this.setLegendPosition=t(this.setLegendPosition,this),this.setCountryColor=t(this.setCountryColor,this),i.__super__.constructor.call(this,e,n),this.formatFloat=d3.format(",.1f"),this.formatInteger=d3.format(",d"),this}return e(i,n),i.prototype.setSVG=function(){return i.__super__.setSVG.call(this),this.$tooltip=this.$el.find(".tooltip")},i.prototype.setScales=function(){return this.color=d3.scaleSequential(d3.interpolateOranges),this},i.prototype.loadData=function(t,e){return d3.queue().defer(d3.csv,t).defer(d3.json,e).await(function(t){return function(e,n,i){return t.$el.trigger("data-loaded"),t.setData(n,i)}}(this)),this},i.prototype.setData=function(t,e){return this.data=this.dataParser(t),this.setColorDomain(),this.options.legend&&this.drawLegend(),this.drawGraph(e),this},i.prototype.setColorDomain=function(){return this.color.domain([0,d3.max(this.data,function(t){return t.value})]),this},i.prototype.drawLegend=function(){var t,e;return t=30,e=this.getLegendData(),this.legend=this.container.append("g").attr("class","legend").call(this.setLegendPosition),this.legend.selectAll("rect").data(e).enter().append("rect").attr("x",function(n,i){return Math.round(t*(i-e.length/2))}).attr("width",t).attr("height",8).attr("fill",function(t){return function(e){return t.color(e)}}(this)),e.shift(),this.legend.selectAll("text").data(e).enter().append("text").attr("x",function(n,i){return Math.round(t*(i+.5-e.length/2))}).attr("y",20).attr("text-anchor","start").text(this.getLegendFormat)},i.prototype.drawGraph=function(t){return this.countries=topojson.feature(t,t.objects.countries),this.countries.features=this.countries.features.filter(function(t){return"010"!==t.id}),this.projection=d3.geoKavrayskiy7(),this.projectionSetSize(),this.path=d3.geoPath().projection(this.projection),this.container.selectAll(".country").data(this.countries.features).enter().append("path").attr("id",function(t){return"country-"+t.id}).attr("class",function(t){return"country"}).attr("fill",this.setCountryColor).attr("stroke-width",1).attr("stroke",this.setCountryColor).attr("d",this.path),this.$tooltip&&this.container.selectAll(".country").on("mouseover",this.onMouseOver).on("mousemove",this.onMouseMove).on("mouseout",this.onMouseOut),this.$el.trigger("draw-complete"),this},i.prototype.updateGraph=function(t){return this.data=this.dataParser(t),this.setColorDomain(),this.container.selectAll(".country").transition().attr("fill",this.setCountryColor).attr("stroke",this.setCountryColor)},i.prototype.updateGraphDimensions=function(){return i.__super__.updateGraphDimensions.call(this),this.projectionSetSize(),this.path.projection(this.projection),this.container.selectAll(".country").attr("d",this.path),this.options.legend&&this.legend.call(this.setLegendPosition),this},i.prototype.projectionSetSize=function(){return this.projection.fitSize([this.width,this.height],this.countries).scale(1.1*this.projection.scale()).translate([.48*this.width,.6*this.height])},i.prototype.setCountryColor=function(t){var e;return e=this.data.filter(function(e){return e.code_num===t.id}),e[0]?this.color(e[0].value):"#eee"},i.prototype.setLegendPosition=function(t){return t.attr("transform","translate("+Math.round(.5*this.width)+","+-this.options.margin.top+")")},i.prototype.getLegendData=function(){return d3.range(0,this.color.domain()[1])},i.prototype.getLegendFormat=function(t){return t},i.prototype.onMouseOver=function(t){var e,n,i;if(i=this.data.filter(function(e){return e.code_num===t.id}),i.length>0)return n=d3.mouse(d3.event.target),this.setTooltipData(i[0]),e=$(d3.event.target).offset(),this.$tooltip.css({left:n[0]-.5*this.$tooltip.width(),top:n[1]-.5*this.$tooltip.height(),opacity:"1"})},i.prototype.onMouseMove=function(t){var e;return e=d3.mouse(d3.event.target),this.$tooltip.css({left:e[0]-.5*this.$tooltip.width(),top:e[1]-.5*this.$tooltip.height()})},i.prototype.onMouseOut=function(t){return this.$tooltip.css("opacity","0")},i.prototype.setTooltipData=function(t){if(this.$tooltip.find(".tooltip-inner .title").html(t.name),this.$tooltip.find(".tooltip-inner .value").html(this.formatFloat(t.value)),t.cases)return this.$tooltip.find(".tooltip-inner .cases").html(this.formatInteger(t.cases))},i}(window.BaseGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;window.LineGraph=function(n){function i(e,n){return this.setTickHoverPosition=t(this.setTickHoverPosition,this),this.setLineLabelHoverPosition=t(this.setLineLabelHoverPosition,this),this.onMouseMove=t(this.onMouseMove,this),this.onMouseOut=t(this.onMouseOut,this),this.setOverlayDimensions=t(this.setOverlayDimensions,this),this.setLabelDimensions=t(this.setLabelDimensions,this),this.getScaleXDomain=t(this.getScaleXDomain,this),i.__super__.constructor.call(this,e,n),this}return e(i,n),i.prototype.yFormat=d3.format("d"),i.prototype.setData=function(t){return this.years=this.getYears(t),i.__super__.setData.call(this,t),this},i.prototype.getYears=function(t){var e;return e=[],d3.keys(t[0]).forEach(function(t){if(+t)return e.push(+t)}),e.sort()},i.prototype.dataParser=function(t){return t.forEach(function(t){return function(e){return e.values={},t.years.forEach(function(t){return e[t]&&(e.values[t]=+e[t]),delete e[t]})}}(this)),t},i.prototype.setScales=function(){return this.x=d3.scaleLinear().range(this.getScaleXRange()),this.y=d3.scaleLinear().range(this.getScaleYRange()),this.xAxis=d3.axisBottom(this.x).tickFormat(d3.format("")),this.yAxis=d3.axisLeft(this.y).tickSize(this.width),this.line=d3.line().curve(d3.curveCatmullRom).x(function(t){return function(e){return t.x(+e.key)}}(this)).y(function(t){return function(e){return t.y(e.value)}}(this)),this.options.isArea&&(this.area=d3.area().curve(d3.curveCatmullRom).x(function(t){return function(e){return t.x(+e.key)}}(this)).y0(this.height).y1(function(t){return function(e){return t.y(e.value)}}(this))),this},i.prototype.getScaleXDomain=function(){return[this.years[0],this.years[this.years.length-1]]},i.prototype.getScaleYDomain=function(){return[0,d3.max(this.data,function(t){return d3.max(d3.values(t.values))})]},i.prototype.drawGraph=function(){return this.container.select(".graph").remove(),this.graph=this.container.append("g").attr("class","graph"),this.drawLines(),this.options.isArea&&this.drawAreas(),this.options.label&&this.drawLabels(),this.options.mouseEvents&&(this.drawLineLabelHover(),this.drawRectOverlay()),this},i.prototype.updateGraphDimensions=function(){return i.__super__.updateGraphDimensions.call(this),this.options.isArea&&this.area.y0(this.height),this.yAxis.tickSize(this.width),this.container.selectAll(".line").attr("d",this.line),this.options.isArea&&this.container.selectAll(".area").attr("d",this.area),this.options.label&&this.container.selectAll(".line-label").call(this.setLabelDimensions),this.options.mouseEvents&&(this.container.select(".overlay").call(this.setOverlayDimensions),this.container.select(".tick-hover").call(this.setTickHoverPosition)),this},i.prototype.drawLines=function(){return this.graph.selectAll(".line").data(this.data).enter().append("path").attr("class","line").attr("id",function(t){return function(e){return"line-"+e[t.options.key.id]}}(this)).datum(function(t){return d3.entries(t.values)}).attr("d",this.line)},i.prototype.drawAreas=function(){return this.graph.selectAll(".area").data(this.data).enter().append("path").attr("class","area").attr("id",function(t){return function(e){return"area-"+e[t.options.key.id]}}(this)).datum(function(t){return d3.entries(t.values)}).attr("d",this.area)},i.prototype.drawLabels=function(){return this.graph.selectAll(".line-label").data(this.data).enter().append("text").attr("class","line-label").attr("id",function(t){return function(e){return"line-label-"+e[t.options.key.id]}}(this)).attr("text-anchor","end").attr("dy","-0.125em").text(function(t){return function(e){return e[t.options.key.x]}}(this)).call(this.setLabelDimensions)},i.prototype.drawLineLabelHover=function(){if(this.container.selectAll(".line-label-point").data(this.data).enter().append("circle").attr("id",function(t){return function(e){return"line-label-point-"+e[t.options.key.id]}}(this)).attr("class","line-label-point").attr("r",4).style("display","none"),this.container.append("text").attr("class","tick-hover").attr("dy","0.71em").style("display","none").call(this.setTickHoverPosition),1===this.data.length)return this.container.append("text").attr("class","line-label-hover").attr("text-anchor","middle").attr("dy","-0.5em").style("display","none")},i.prototype.drawRectOverlay=function(){return this.container.append("rect").attr("class","overlay").call(this.setOverlayDimensions).on("mouseover",this.onMouseMove).on("mouseout",this.onMouseOut).on("mousemove",this.onMouseMove)},i.prototype.setLabelDimensions=function(t){return t.attr("x",this.width).attr("y",function(t){return function(e){return t.y(e.values[t.years[t.years.length-1]])}}(this))},i.prototype.setOverlayDimensions=function(t){return t.attr("width",this.width).attr("height",this.height)},i.prototype.onMouseOut=function(t){return this.$el.trigger("mouseout"),this.hideLabel()},i.prototype.onMouseMove=function(t){var e,n;if(e=d3.mouse(d3.event.target),n=Math.round(this.x.invert(e[0])),n!==this.currentYear)return this.$el.trigger("change-year",n),this.setLabel(n)},i.prototype.setLabel=function(t){return this.currentYear=t,this.container.select(".x.axis").selectAll(".tick").style("display","none"),this.container.selectAll(".line-label-point").each(function(t){return function(e){return t.setLineLabelHoverPosition(e)}}(this)),this.container.select(".tick-hover").style("display","block").attr("x",Math.round(this.x(this.currentYear))).text(this.currentYear)},i.prototype.hideLabel=function(){return this.container.selectAll(".line-label-point").style("display","none"),this.container.selectAll(".line-label-hover").style("display","none"),this.container.select(".x.axis").selectAll(".tick").style("display","block"),this.container.select(".tick-hover").style("display","none")},i.prototype.setLineLabelHoverPosition=function(t){var e,n,i;for(i=this.currentYear;this.years.indexOf(i)===-1&&this.currentYear>this.years[0];)i--;return this.currentYear=i,n=d3.select("#line-label-point-"+t[this.options.key.id]),e=this.container.selectAll(".line-label-hover"),t.values[i]?(n.style("display","block"),e.style("display","block"),n.attr("cx",function(t){return function(e){return t.x(i)}}(this)).attr("cy",function(e){return function(n){return t.values[i]?e.y(t.values[i]):0}}(this)),e.attr("x",function(t){return function(e){return t.x(i)}}(this)).attr("y",function(e){return function(n){return t.values[i]?e.y(t.values[i]):0}}(this)).text(function(e){return function(n){return t.values[i]?e.yFormat(t.values[i]):""}}(this))):(n.style("display","none"),void e.style("display","none"))},i.prototype.setTickHoverPosition=function(t){return t.attr("y",Math.round(this.height+this.options.margin.top+9))},i}(window.BaseGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;window.ContraceptivesUseMapGraph=function(n){function i(){return this.onResize=t(this.onResize,this),this.getLegendFormat=t(this.getLegendFormat,this),i.__super__.constructor.apply(this,arguments)}return e(i,n),i.prototype.currentState=0,i.prototype.states=[{id:"Female sterilization",text:{es:"esterilización femenina",en:"female sterilization"},labels:[{cx_factor:.7,cy_factor:.48,r:0,textOffset:[-20,30],label:{es:"India",en:"India"}},{cx_factor:.27,cy_factor:.465,r:0,textOffset:[20,-5],label:{es:"República Dominicana",en:"Dominican Republic"}}]},{id:"Male sterilization",text:{es:"esterilización masculina",en:"male sterilization"},labels:[{cx_factor:.265,cy_factor:.28,r:0,textOffset:[30,25],label:{es:"Canadá",en:"Canada"}}]},{id:"IUD",text:{es:"DIU",en:"IUD"},labels:[{cx_factor:.85,cy_factor:.32,r:0,textWidth:80,textOffset:[12,0],label:{es:"Corea del Norte",en:"North Korea"}}]},{id:"IUD",text:{es:"DIU",en:"IUD"},labels:[{cx_factor:.84,cy_factor:.41,r:0,textWidth:80,textOffset:[12,0],label:{es:"China",en:"China"}}]},{id:"Pill",text:{es:"píldora",en:"pill"},labels:[{cx_factor:.464,cy_factor:.41,r:0,textOffset:[-35,0],label:{es:"Argelia",en:"Algeria"}}]},{id:"Male condom",text:{es:"preservativo masculino",en:"male condom"},labels:[{cx_factor:.542,cy_factor:.335,r:0,textOffset:[-12,0],label:{es:"Grecia",en:"Greece"}},{cx_factor:.564,cy_factor:.74,r:0,textOffset:[15,-10],label:{es:"Botsuana",en:"Botswana"}}]},{id:"Injectable",text:{es:"inyectable",en:"injectable"},labels:[{cx_factor:.62,cy_factor:.55,r:0,textOffset:[15,0],label:{es:"Etiopía",en:"Ethiopia"}}]},{id:"Any traditional method",text:{es:"métodos tradicionales",en:"traditional methods"},labels:[{cx_factor:.536,cy_factor:.3,r:16,textOffset:[-26,0],label:{es:"Balcanes",en:"Balkans"}}]},{id:"Any traditional method",text:{es:"métodos tradicionales",en:"traditional methods"},labels:[{cx_factor:.534,cy_factor:.31,r:0,textOffset:[-10,0],label:{es:"Albania",en:"Albania"}}]}],i.prototype.getLegendData=function(){return[0,20,40,60,80]},i.prototype.getLegendFormat=function(t){return t+"%"},i.prototype.getDimensions=function(){var t,e;return e=100,this.$el&&(t=$("body").height()-e,this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth*this.options.aspectRatio,this.containerHeight>t&&(this.containerHeight=t,this.containerWidth=this.containerHeight/this.options.aspectRatio),this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},i.prototype.onResize=function(){return i.__super__.onResize.call(this),this.setAnnotations()},i.prototype.setColorDomain=function(){return this.color.domain([0,80]),this},i.prototype.drawGraph=function(t){return i.__super__.drawGraph.call(this,t),this.ringNote=d3.ringNote(),this},i.prototype.setMapState=function(t){if(t!==this.currentState&&(this.currentState=t,this.currentMethod=this.states[this.currentState-1],this.currentMethod))return $("#map-contraceptives-use-method").html(this.currentMethod.text[this.options.lang]),this.data.forEach(function(t){return function(e){return e.value=+e[t.currentMethod.id]}}(this)),this.updateGraph(this.data),this.setAnnotations()},i.prototype.setAnnotations=function(){if(this.currentMethod)return this.currentMethod.labels.forEach(function(t){return function(e){return e.cx=e.cx_factor*t.width,e.cy=e.cy_factor*t.height,e.text=e.label[t.options.lang]}}(this)),this.container.call(this.ringNote,this.currentMethod.labels)},i}(window.MapGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;window.TreemapGraph=function(n){function i(e,n){return this.isNodeLabelVisible=t(this.isNodeLabelVisible,this),this.setNodeLabel=t(this.setNodeLabel,this),this.setNodeDimensions=t(this.setNodeDimensions,this),this.setNode=t(this.setNode,this),n.minSize=n.minSize||60,n.nodesPadding=n.nodesPadding||8,n.transitionDuration=n.transitionDuration||600,n.mobileBreakpoint=n.mobileBreakpoint||620,i.__super__.constructor.call(this,e,n),this}return e(i,n),i.prototype.drawScales=function(){return this},i.prototype.setSVG=function(){return this.container=d3.select("#"+this.id).append("div").attr("class","nodes-container").style("height",this.height+"px")},i.prototype.drawGraph=function(){return this.treemap=d3.treemap().size([this.width,this.height]).padding(0).round(!0),this.width<=this.options.mobileBreakpoint&&this.treemap.tile(d3.treemapSlice),this.stratify=d3.stratify().parentId(function(t){return t.parent}),this.updateGraph(),this},i.prototype.updateGraph=function(){var t;return this.treemapRoot=this.stratify(this.data).sum(function(t){return function(e){return e[t.options.key.value]}}(this)).sort(function(t,e){return e.value-t.value}),this.treemap(this.treemapRoot),t=this.container.selectAll(".node").data(this.treemapRoot.leaves()),this.container.selectAll(".node-label").data(this.treemapRoot.leaves()),t.enter().append("div").attr("class","node").append("div").attr("class","node-label").append("div").attr("class","node-label-content").append("p"),this.container.selectAll(".node").call(this.setNode).call(this.setNodeDimensions),this.container.selectAll(".node-label").style("visibility","hidden").call(this.setNodeLabel).filter(this.isNodeLabelVisible).style("visibility","visible"),t.exit().remove(),this},i.prototype.getDimensions=function(){return i.__super__.getDimensions.call(this),this.width<=this.options.mobileBreakpoint&&(this.containerHeight=this.containerWidth,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},i.prototype.updateGraphDimensions=function(){return i.__super__.updateGraphDimensions.call(this),this.container.style("height",this.height+"px"),this.width<=this.options.mobileBreakpoint?this.treemap.tile(d3.treemapSlice):this.treemap.tile(d3.treemapSquarify),this.treemap.size([this.width,this.height]),this.treemap(this.treemapRoot),this.container.selectAll(".node").data(this.treemapRoot.leaves()).call(this.setNodeDimensions),this.container.selectAll(".node-label").style("visibility","hidden").filter(this.isNodeLabelVisible).style("visibility","visible"),this},i.prototype.setNode=function(t){return t.attr("class",this.getNodeClass).style("padding",function(t){return function(e){return e.x1-e.x0>2*t.options.nodesPadding&&e.y1-e.y0>2*t.options.nodesPadding?t.options.nodesPadding+"px":0}}(this)).style("visibility",function(t){return t.x1-t.x0===0||t.y1-t.y0===0?"hidden":""})},i.prototype.setNodeDimensions=function(t){return t.style("left",function(t){return t.x0+"px"}).style("top",function(t){return t.y0+"px"}).style("width",function(t){return t.x1-t.x0+"px"}).style("height",function(t){return t.y1-t.y0+"px"})},i.prototype.setNodeLabel=function(t){return t.select("p").attr("class",function(t){return t.value>25?"size-l":t.value<10?"size-s":""}).html(function(t){return function(e){return e.data[t.options.key.id]}}(this))},i.prototype.isNodeLabelVisible=function(t){return t.x1-t.x0>this.options.minSize&&t.y1-t.y0>this.options.minSize},i.prototype.getNodeClass=function(t){return"node"},i}(window.BaseGraph)}.call(this),function(){var t=function(t,n){function i(){this.constructor=t}for(var o in n)e.call(n,o)&&(t[o]=n[o]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},e={}.hasOwnProperty;window.ContraceptivesUseTreemapGraph=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.dataParser=function(t,e,n){var i,o,a,r,s,l;if(s=[{id:"r"}],i=t.filter(function(t){return t.code===e}),i[0]){r={},this.options.methodsKeys.forEach(function(t){return function(e,n){return i[0][e]?r[e]={id:e.toLowerCase().replace(/ /g,"-").replace(")","").replace("(",""),name:t.options.methodsNames[n],value:+i[0][e]}:void 0}}(this));for(o in r)a=r[o],"Other modern methods"!==o&&"Any traditional method"!==o&&a.value<5&&(r["Other modern methods"].value+=a.value,delete r[o]);for(o in r)a=r[o],s.push({id:a.id,raw_name:a.name,name:"<strong>"+a.name.charAt(0).toUpperCase()+a.name.slice(1)+"</strong><br/>"+Math.round(a.value)+"%",value:a.value,parent:"r"});l=s.sort(function(t,e){return t.value&&e.value?e.value-t.value:1}),$("#treemap-contraceptives-use-country").html(n),$("#treemap-contraceptives-use-any-method").html(Math.round(i[0]["Any modern method"])),$("#treemap-contraceptives-use-method").html(l[0].raw_name)}return s},n.prototype.setData=function(t,e,n){return this.originalData=t,this.data=this.dataParser(this.originalData,e,n),this.drawGraph(),this.$el.trigger("draw-complete"),this},n.prototype.updateData=function(t,e){return this.data=this.dataParser(this.originalData,t,e),this.updateGraph(),this},n.prototype.getNodeClass=function(t){return"node node-"+t.id},n}(window.TreemapGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function i(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;window.BeeswarmScatterplotGraph=function(n){function i(e,n){return this.getColorDomain=t(this.getColorDomain,this),this.getSizeDomain=t(this.getSizeDomain,this),this.getSizeRange=t(this.getSizeRange,this),this.getScaleYDomain=t(this.getScaleYDomain,this),this.getScaleXDomain=t(this.getScaleXDomain,this),this.setXAxisPosition=t(this.setXAxisPosition,this),this.getDotFill=t(this.getDotFill,this),this.getPositionY=t(this.getPositionY,this),this.getPositionX=t(this.getPositionX,this),this.setDotLabelPosition=t(this.setDotLabelPosition,this),this.setDotPosition=t(this.setDotPosition,this),this.setDot=t(this.setDot,this),n.dotSize=n.dotSize||5,n.dotMinSize=n.dotMinSize||2,n.dotMaxSize=n.dotMaxSize||15,n.mode=n.mode||0,i.__super__.constructor.call(this,e,n),this}return e(i,n),i.prototype.incomeLevels=[1005,3955,12235],i.prototype.labels=["AGO","BGD","BRA","CHN","DEU","ESP","ETH","IND","IDN","JPN","NGA","PAK","PHL","RUS","SAU","TUR","UGA","USA","VNM"],i.prototype.dataParser=function(t){return this.options.key.size?t.sort(function(t){return function(e,n){return n[t.options.key.size]-e[t.options.key.size]}}(this)):t},i.prototype.drawGraph=function(){if(this.setSize(),this.setSimulation(),this.runSimulation(),this.container.selectAll(".dot").data(this.data).enter().append("circle").attr("class","dot").attr("id",function(t){return function(e){return"dot-"+e[t.options.key.id]}}(this)).call(this.setDot),this.options.key.label)return this.container.selectAll(".dot-label").data(this.data.filter(function(t){return function(e){return t.labels.indexOf(e[t.options.key.id])!==-1}}(this))).enter().append("text").attr("class",function(t){return function(e){return e[t.options.key.size]>1e9?"dot-label size-l":e[t.options.key.size]>18e7?"dot-label size-m":"dot-label"}}(this)).attr("dy","0.25em").text(function(t){return function(e){return e[t.options.key.label]}}(this)).call(this.setDotLabelPosition)},i.prototype.setSimulation=function(){var t;return t=d3.forceY(function(t){return function(e){return t.y(e[t.options.key.y])}}(this)),t.strength(1),this.simulation=d3.forceSimulation(this.data).force("x",t).force("y",d3.forceX(.5*this.width)).force("collide",d3.forceCollide(function(t){return function(e){return t.size?e.radius+1:t.options.dotSize+1}}(this))).stop()},i.prototype.runSimulation=function(){var t,e;for(t=0,e=[];t<350;)this.simulation.tick(),e.push(++t);return e},i.prototype.setDot=function(t){return t.attr("r",function(t){return function(e){return t.size?e.radius:t.options.dotSize}}(this)).attr("fill",this.getDotFill).call(this.setDotPosition)},i.prototype.setDotPosition=function(t){return t.attr("cx",this.getPositionX).attr("cy",this.getPositionY)},i.prototype.setDotLabelPosition=function(t){return t.attr("x",this.getPositionX).attr("y",this.getPositionY)},i.prototype.getPositionX=function(t){return 0===this.options.mode?t.x:Math.round(this.x(t[this.options.key.x]))},i.prototype.getPositionY=function(t){return 0===this.options.mode?t.y:Math.round(this.y(t[this.options.key.y]))},i.prototype.getDotFill=function(t){return this.color(t[this.options.key.color])},i.prototype.setMode=function(t){return this.options.mode=t,this.options.mode<2?(this.container.selectAll(".dot, .dot-label").classed("inactive",!1),this.container.selectAll(".dot").call(this.setDotPosition),this.xLegend&&this.xLegend.style("opacity",this.options.mode),this.options.key.label&&this.container.selectAll(".dot-label").style("opacity",0).call(this.setDotLabelPosition).transition().delay(500).style("opacity",1),this.container.selectAll(".x.axis .tick line").style("opacity",this.options.mode)):2===this.options.mode?this.container.selectAll(".dot, .dot-label").classed("inactive",function(t){return function(e){return e[t.options.key.x]<t.incomeLevels[2]||e[t.options.key.y]>15}}(this)):3===this.options.mode?this.container.selectAll(".dot, .dot-label").classed("inactive",function(t){return function(e){return e[t.options.key.x]>t.incomeLevels[1]||e[t.options.key.y]<30}}(this)):4===this.options.mode?this.container.selectAll(".dot, .dot-label").classed("inactive",function(t){return function(t){return"SAU"!==t.id&&"JPN"!==t.id}}(this)):5===this.options.mode?this.container.selectAll(".dot, .dot-label").classed("inactive",!1):void 0},i.prototype.setSize=function(){if(this.size)return this.data.forEach(function(t){return function(e){return e.radius=t.size(e[t.options.key.size])}}(this))},i.prototype.updateGraphDimensions=function(){return this.xAxis.tickSize(this.height),
this.yAxis.tickSize(this.width),i.__super__.updateGraphDimensions.call(this),this.setSimulation(),this.runSimulation(),this.container.selectAll(".dot").call(this.setDotPosition),this.options.key.label&&this.container.selectAll(".dot-label").call(this.setDotLabelPosition),this},i.prototype.setScales=function(){return this.x=d3.scaleLog().range(this.getScaleXRange()),this.y=d3.scaleLinear().range(this.getScaleYRange()),this.options.key.size&&(this.size=d3.scalePow().exponent(.5).range(this.getSizeRange())),this.options.key.color&&(this.color=d3.scaleThreshold().range(d3.schemeOranges[5])),this.xAxis=d3.axisBottom(this.x).tickSize(this.height).tickValues(this.incomeLevels),this.yAxis=d3.axisLeft(this.y).tickSize(this.width).tickValues([0,10,20,30,40]).tickFormat(function(t){return t+"%"}),this},i.prototype.setXAxisPosition=function(t){return t.attr("transform","translate(-1,5)")},i.prototype.getScaleXDomain=function(){return[250,85e3]},i.prototype.getScaleYDomain=function(){return[0,d3.max(this.data,function(t){return function(e){return e[t.options.key.y]}}(this))]},i.prototype.getSizeRange=function(){return[this.options.dotMinSize,this.options.dotMaxSize]},i.prototype.getSizeDomain=function(){return[0,d3.max(this.data,function(t){return function(e){return e[t.options.key.size]}}(this))]},i.prototype.getColorDomain=function(){return[0,10,20,30]},i.prototype.drawScales=function(){var t,e;return this.x.domain(this.getScaleXDomain()),this.y.domain(this.getScaleYDomain()),this.size&&this.size.domain(this.getSizeDomain()),this.color&&this.color.domain(this.getColorDomain()),this.xAxis&&(this.container.append("g").attr("class","x axis").call(this.setXAxisPosition).call(this.xAxis),this.container.selectAll(".x.axis .tick line").attr("y1",this.y(40)-4)),this.yAxis&&(this.container.append("g").attr("class","y axis").call(this.setYAxisPosition).call(this.yAxis),this.container.selectAll(".y.axis .tick text").attr("dx",3).attr("dy",-4)),t=this.xAxis.tickValues(),t.unshift(0),e=this.x(this.getScaleXDomain()[1]),t=t.map(function(t){return function(n){return n>0?100*t.x(n)/e:0}}(this)),t.push(100),this.xLegend=d3.select(d3.select("#"+this.id).node().parentNode).select(".x-legend"),this.xLegend.selectAll("li").style("width",function(e,n){return t[n+1]-t[n]+"%"}),this},i.prototype.getDimensions=function(){return this.$el&&(this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth>680?this.containerWidth*this.options.aspectRatio:this.containerWidth>520?.75*this.containerWidth:this.containerWidth,this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},i}(window.BaseGraph)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.ContraceptivesApp=function(){function e(e,n,i,o,a,r,s,l,c,h,p){this.onSelectFilter=t(this.onSelectFilter,this),this.onSelectCountry=t(this.onSelectCountry,this),this.sentences=this.sentences[e],this.data={use:n,unmetneeds:i,reasons:o},this.methodsKeys=r,this.methodsNames=s,this.methodsDHSNames=l,this.reasonsNames=c,this.reasonsDHSNames=h,this.pym=p,this.$app=$("#contraceptives-app"),this.$app.find(".select-country").select2().change(this.onSelectCountry).val(a.code).trigger("change"),this.$app.find(".contraceptives-app-filters .btn").click(this.onSelectFilter),this.$app.css("opacity",1)}return e.prototype.filter_keys={"contraceptives-filter-0":"residence","contraceptives-filter-1":"age","contraceptives-filter-2":"education","contraceptives-filter-3":"wealth"},e.prototype.dhs_countries={AFG:{name:"AFIR70DT",year:"2017"},ALB:{name:"ALIR50DT",year:"2008-09"},ARM:{name:"AMIR61DT",year:"2010"},AGO:{name:"AOIR71DT",year:"2015-16"},AZE:{name:"AZIR52DT",year:"2006"},BGD:{name:"BDIR72DT",year:"2014"},BEN:{name:"BJIR51DT",year:"2006"},BOL:{name:"BOIR51DT",year:"2008"},BDI:{name:"BUIR61DT",year:"2010"},COD:{name:"CDIR61DT",year:"2013-14"},COG:{name:"CGIR60DT",year:"2011-12"},CIV:{name:"CIIR62DT",year:"2011-12"},CMR:{name:"CMIR61DT",year:"2011"},COL:{name:"COIR71DT",year:"2015-16"},DOM:{name:"DRIR61DT",year:"2013"},EGY:{name:"EGIR61DT",year:"2014"},ETH:{name:"ETIR70DT",year:"2016"},GHA:{name:"GHIR72DT",year:"2014"},GMB:{name:"GMIR60DT",year:"2013"},GIN:{name:"GNIR62DT",year:"2012"},GTM:{name:"GUIR71DT",year:"2014-15"},GUY:{name:"GYIR5IDT",year:"2009"},HND:{name:"HNIR62DT",year:"2011-12"},HTI:{name:"HTIR61DT",year:"2012"},IND:{name:"IAIR71DT",year:"2015"},IDN:{name:"IDIR63DT",year:"2012"},JOR:{name:"JOIR6CDT",year:"2012"},KEN:{name:"KEIR70DT",year:"2014"},KHM:{name:"KHIR73DT",year:"2014"},LBR:{name:"LBIR6ADT",year:"2013"},LSO:{name:"LSIR71DT",year:"2014"},MAR:{name:"MAIR43DT",year:"2003-04"},MDG:{name:"MDIR51DT",year:"2008-09"},MLI:{name:"MLIR53DT",year:"2006"},MMR:{name:"MMIR71DT",year:"2016"},MWI:{name:"MWIR7HDT",year:"2015-16"},MOZ:{name:"MZIR62DT",year:"2011"},NGA:{name:"NGIR6ADT",year:"2013"},NER:{name:"NIIR51DT",year:"2006"},NAM:{name:"NMIR61DT",year:"2013"},NPL:{name:"NPIR7HDT",year:"2016"},PER:{name:"PEIR6IDT",year:"2012"},PHL:{name:"PHIR61DT",year:"2013"},PAK:{name:"PKIR61DT",year:"2012-13"},RWA:{name:"RWIR70DT",year:"2015"},SLE:{name:"SLIR61DT",year:"2013"},SEN:{name:"SNIR6DDT",year:"2012-13"},STP:{name:"STIR50DT",year:"2008"},SWZ:{name:"SZIR51DT",year:"2006"},TCD:{name:"TDIR71DT",year:"2014-15"},TGO:{name:"TGIR61DT",year:"2013-14"},TJK:{name:"TJIR61DT",year:"2012"},TLS:{name:"TLIR61DT",year:"2009-10"},TZA:{name:"TZIR7HDT",year:"2015-16"},UGA:{name:"UGIR60DT",year:"2011"},ZMB:{name:"ZMIR51DT",year:"2007"},ZWE:{name:"ZWIR71DT",year:"2015"}},e.prototype.sentences={es:{ALB:"La marcha atrás es el primer método anticonceptivo de Albania. Además, se trata del segundo país donde existe mayor oposición de la propia mujer, la pareja o la religión a tomar anticonceptivos.",ARG:'<a href="https://www.clarin.com/sociedad/campana-ley-aborto-comenzo-2005-proyecto-presento-veces_0_BJvdi0nPz.html" target="_blank">Unas cinco mil mujeres marcharon en febrero de 2018 frente al Congreso argentino para pedir la legalización del aborto.</a>',AUS:'<a href="http://www.abc.net.au/news/health/2017-07-22/natural-methods-of-contraception-on-the-rise-in-australia/8683346" target="_blank">Muchos australianos están volviendo a utilizar métodos tradicionales de anticoncepción, según un estudio de Monash University.</a>',BEL:'<a href="http://www.dutchnews.nl/news/archives/2017/03/she-decides-foundation-brings-in-e181m-for-family-planning-campaign/" target="_blank">Bélgica donó 10 millones de euros para la campaña <i>She Decides</i>, lanzada por el Gobierno holandés para contrarrestar la retirada de fondos para planificación familiar de Trump.</a>',BOL:'<a href="https://www.efe.com/efe/america/sociedad/la-vergüenza-y-el-estigma-de-pedir-preservativos-en-bolivia//20000013-3265652" target="_blank">Farmacias de Bolivia implementaron códigos secretos para pedir preservativos y evitar el estigma de comprar estos anticonceptivos.</a>',CHN:'<a href="https://www.nytimes.com/2017/01/07/world/asia/after-one-child-policy-outrage-at-chinas-offer-to-remove-iuds.html" target="_blank">El Gobierno chino ofrece la retirada gratuita de DIUs después de la política del hijo único.</a>',SLV:'<a href="https://www.theguardian.com/global-development-professionals-network/gallery/2017/may/26/reproductive-rights-zika-women-el-salvador-in-pictures" target="_blank">El Salvador es el único país del mundo donde abortar está penado con cárcel.</a>',FIN:'<a href="http://www.helsinkitimes.fi/finland/finland/news/domestic/15271-helsinki-to-offer-year-s-worth-of-contraceptive-pills-to-under-25-year-olds.html" target="_blank">El ayuntamiento de Helsinki proporciona anticonceptivos de manera gratuita a los jóvenes menores de 25 años.</a>',FRA:'<a href="https://www.connexionfrance.com/French-news/French-women-opt-for-alternatives-as-Pill-use-drops" target="_blank">El uso de las pastillas anticonceptivas se ha reducido en Francia desde 2010.</a>',GMB:"En Gambia, muchas mujeres utilizan un método tradicional que consiste en atar a la cintura una cuerda, una rama, o un papelito con o sin frases del Corán.",DEU:'<a href="http://www.dw.com/en/free-prescribed-contraception-for-low-earners/a-38161577" target="_blank">Un proyecto alemán facilita anticonceptivos de forma gratuita a mujeres de más de 20 años con ingresos bajos.</a>',GTM:'<a href="http://buff.ly/2taYwco" target="_blank">La religión influye en la educación sexual de los jóvenes guatemaltecos.</a>',ISR:"En los sectores judíos más ortodoxos, solo pueden usarse los anticonceptivos si el rabino da su permiso a la mujer.",JPN:"Japón, aunque se encuentra en el grupo de países con renta alta, es la excepción: las necesidades no cubiertas con anticonceptivos está al nivel de países con rentas bajas.",PRK:"El 95% de mujeres que utilizan anticonceptivos en Corea del Norte han elegido el DIU. Se trata del mayor porcentaje de uso a nivel mundial.",NLD:'<a href="http://www.dutchnews.nl/news/archives/2017/03/she-decides-foundation-brings-in-e181m-for-family-planning-campaign/" target="_blank">El gobierno holandés lanza el proyecto <i>She Decides</i> para contrarrestar la retirada de fondos para planificación familiar de Trump.</a>',PER:'<a href="https://interactive.quipu-project.com/#/es/quipu/intro" target="_blank">En la época de los 90, durante el gobierno de Fujimori, más de 250.000 mujeres fueron esterilizadas sin su consentimiento.</a>',PHL:'<a href="https://www.theguardian.com/global-development/2017/jul/10/how-bitter-herbs-and-botched-abortions-kill-three-women-a-day-in-the-philippines" target="_blank"> En un país donde el aborto del está prohibido, tres mujeres mueren al día por complicaciones derivadas de intervenciones ilegales.</a>',POL:'<a href="https://www.amnesty.org/en/latest/news/2017/06/poland-emergency-contraception-restrictions-catastrophic-for-women-and-girls/" target="_blank">El Gobierno polaco da un paso atrás y se convierte en el único país de la Unión Europea donde la pastilla del día después está sujeta a prescripción.</a>',SSD:'<a href="https://www.theguardian.com/global-development/2017/may/25/every-year-i-give-birth-war-driving-contraception-crisis-sudan-nuba-mountains" target="_blank">La guerra en Sudán está creando una crisis en el acceso a anticonceptivos.</a>',ESP:'<a href="http://cadenaser.com/emisora/2017/09/19/radio_madrid/1505842932_131031.html" target="_blank">Madrid es la única comunidad que no financia anticonceptivos con sus fondos.</a>',TUR:'<a href="http://www.bbc.com/news/world-europe-36413097" target="_blank">Erdogan declara que la planificación familiar no es para los musulmanes.</a>',UGA:'<a href="https://www.newvision.co.ug/new_vision/news/1458882/uganda-facing-150-million-condom-shortfall" target="_blank">En 2017, el Ministerio de Salud de Uganda declaraba un desabastecimiento de 150 millones de preservativos masculinos.</a>',GBR:'<a href=https://www.theguardian.com/world/2018/jan/29/ireland-to-greenlight-referendum-on-abortion-law-reform" target="_blank">En Irlanda es ilegal abortar a no ser que haya un riesgo real de salud para la madre.</a>',USA:'<a href="https://www.nytimes.com/2018/01/18/us/health-care-office-abortion-contraception.html" target="_blank">Trump da a los médicos libertad para negarse a realizar procedimientos en contra de sus creencias religiosas, como el aborto.</a>',VEN:'<a href="http://www.bbc.com/mundo/noticias-america-latina-42635412" target="_blank">La escasez y el precio elevado de los anticonceptivos en Venezuela influye en el aumento de embarazos no deseados.</a>',ZMB:'<a href="https://www.ideo.org/project/diva-centres" target="_blank">Un proyecto en Zambia  une la manicura y los anticonceptivos.</a>'},en:{ALB:"Withdrawn is the most used contraceptive method by Albanian women. Furthermore, it is the second country where the opposition of the respondent, the partner or the religion to use contraceptive methods is the main barrier for using them when they are needed.",ARG:'<a href="https://www.clarin.com/sociedad/campana-ley-aborto-comenzo-2005-proyecto-presento-veces_0_BJvdi0nPz.html" target="_blank">Approximately five thousand women marched in February 2018 in front of the Argentine Congress to demand the legalization of abortion. </a>',AUS:'<a href="http://www.abc.net.au/news/health/2017-07-22/natural-methods-of-contraception-on-the-rise-in-australia/8683346" target="_blank">Natural methods of contraception on the rise in Australia, according to an investigation of Monash University. </a>',BEL:'<a href="http://www.dutchnews.nl/news/archives/2017/03/she-decides-foundation-brings-in-e181m-for-family-planning-campaign/" target="_blank">Belgium have donated 10 million euros to the <i>She Decides</i> proyect, launched by the Dutch government to boost contraception in developing countries. </a>',BOL:'<a href="https://www.efe.com/efe/america/sociedad/la-vergüenza-y-el-estigma-de-pedir-preservativos-en-bolivia//20000013-3265652" target="_blank">Bolivia\'s pharmacies have developed a secret code to ask for condoms and therefore, to avoid stigma about buying them.</a>',CHN:'<a href="https://www.nytimes.com/2017/01/07/world/asia/after-one-child-policy-outrage-at-chinas-offer-to-remove-iuds.html" target="_blank">After one child policiy, outrage at China\'s offer to remove IUDs.</a>',SLV:'<a href="https://www.theguardian.com/global-development-professionals-network/gallery/2017/may/26/reproductive-rights-zika-women-el-salvador-in-pictures" target="_blank">El Salvador is one of six countries where abortion is banned under any circumstances, and women who undergo it could face prison </a>',FIN:'<a href="http://www.helsinkitimes.fi/finland/finland/news/domestic/15271-helsinki-to-offer-year-s-worth-of-contraceptive-pills-to-under-25-year-olds.html" target="_blank">Helsinki to offer year’s worth of contraceptive pills to under 25-year-olds.</a>',FRA:'<a href="https://www.connexionfrance.com/French-news/French-women-opt-for-alternatives-as-Pill-use-drops" target="_blank">French women opt for alternatives as Pill use drops.</a>',GMB:"In The Gambia, many women use a traditional method that involves tying a rope, a branch or a piece of paper around the waist with -or without- phrases from the Koran in it.",DEU:'<a href="http://www.dw.com/en/free-prescribed-contraception-for-low-earners/a-38161577" target="_blank">A trial scheme in Germany is helping women on low incomes to avoid sacrificing their contraception.</a>',GTM:'<a href="http://buff.ly/2taYwco" target="_blank">Religion has a major influence in sexual education of Guatemala young people.</a>',ISR:"In ultra orthodox judaism, contraceptive use is only permitted if the rabbi gives previous permission to the woman.",JPN:"Japan, even if it is part of the group of countries with high income, has unmet needs for contraception at the level of countries with low income.",PRK:"95% of women who use contraceptive methods in North Korea have chosen to use IUDs. It is the highest percentage of use of this method worldwide.",NLD:'<a href="http://www.dutchnews.nl/news/archives/2017/03/she-decides-foundation-brings-in-e181m-for-family-planning-campaign/" target="_blank">Dutch initiative brings in €181m for family planning campaign.</a>',PER:'<a href="https://interactive.quipu-project.com/#/es/quipu/intro" target="_blank">In the 1990s, Alberto Fujimori, former president of Peru, launched a new family planning programme that resulted in the sterilisation of 272,028 women and 22,004 men in only 4 years.</a>',PHL:'<a href="https://www.theguardian.com/global-development/2017/jul/10/how-bitter-herbs-and-botched-abortions-kill-three-women-a-day-in-the-philippines" target="_blank"> How bitter herbs and botched abortions kill three women a day in the Philippines.</a>',POL:'<a href="https://www.amnesty.org/en/latest/news/2017/06/poland-emergency-contraception-restrictions-catastrophic-for-women-and-girls/" target="_blank">Polish Government takes a step back in the access to the "morning-after" pill and it becomes the only European country where women need a prescription for the use of this contraceptive method.</a>',SSD:'<a href="https://www.theguardian.com/global-development/2017/may/25/every-year-i-give-birth-war-driving-contraception-crisis-sudan-nuba-mountains" target="_blank">\'Every year, I give birth\': why war is driving a contraception crisis in Sudan.</a>',ESP:'<a href="http://cadenaser.com/emisora/2017/09/19/radio_madrid/1505842932_131031.html" target="_blank">Madrid is the only regional government that does not finance contraceptive methods with its funds.</a>',TUR:'<a href="http://www.bbc.com/news/world-europe-36413097" target="_blank">Turkey\'s Erdogan warns Muslims against birth control.</a>',UGA:'<a href="https://www.newvision.co.ug/new_vision/news/1458882/uganda-facing-150-million-condom-shortfall" target="_blank">In 2017, Uganda faced a 150 millions male condoms shortfall.</a>',GBR:'<a href=https://www.theguardian.com/world/2018/jan/29/ireland-to-greenlight-referendum-on-abortion-law-reform" target="_blank">Irish referendum on abortion reform to be held by end of May 2018</a>',USA:'<a href="https://www.nytimes.com/2018/01/18/us/health-care-office-abortion-contraception.html" target="_blank">Trump gives health workers new religious liberty protections.</a>',VEN:'<a href="http://www.bbc.com/mundo/noticias-america-latina-42635412" target="_blank">The shortage and high price of contraceptives in Venezuela influences the increase in unwanted pregnancies</a>',ZMB:'<a href="https://www.ideo.org/project/diva-centres" target="_blank">In Zambia, a radical new approach to contraception is giving adolescent girls the information and services of contraception while doing the manicure.</a>'}},e.prototype.onSelectCountry=function(t){var e,n,i,o,a,r,s,l,c,h,p;return this.country_code=$(t.target).val(),p=null,a=null,r=null,h=null,s=null,l=null,this.$app.find(".contraceptives-app-filters").hide().find(".btn").removeClass("active"),$(".contraceptives-filter").hide(),this.$app.find(".contraceptives-app-label-small").hide(),this.dhs_countries[this.country_code]?(this.$app.find("#contraceptives-app-data-year").html(this.dhs_countries[this.country_code].year),this.$app.find(".contraceptives-app-label-small").show(),d3.csv($("body").data("baseurl")+"/data/contraceptives-reasons/"+this.dhs_countries[this.country_code].name+"_all.csv",function(t){return function(e,n){var i;if(i=n[0],t.setAppItemData(t.$app,100*(i.n-i.not_using_contraception)/i.n,t.methodsDHSNames[i.most_popular_method],100*i.most_popular_method_n/i.n,100*i.with_unmet_needs/i.n,t.reasonsDHSNames[i.most_popular_reason],100*i.most_popular_reason_n/i.n_reasons,t.sentences[t.country_code]),t.$app.find(".contraceptives-app-filters").show(),t.pym)return t.pym.sendHeight()}}(this))):(i=this.data.use.filter(function(t){return function(e){return e.code===t.country_code}}(this)),i&&i[0]&&(this.$app.find("#contraceptives-app-data-year").html(i[0]["survey year"]),this.$app.find(".contraceptives-app-label-small").show(),"0"!==i[0]["Any modern method"]&&(p=parseFloat(i[0]["Any modern method"])+parseFloat(i[0]["Any traditional method"])),o=this.methodsKeys.map(function(t){return function(e,n){return{name:t.methodsNames[n],value:+i[0][e]}}}(this)),o=o.sort(function(t,e){return e.value-t.value}),a=o[0].name,r=o[0].value),n=this.data.unmetneeds.filter(function(t){return function(e){return e.code===t.country_code}}(this)),n&&n[0]&&(h=n[0].survey?n[0].survey:n[0].estimated,0===i.length&&(this.$app.find("#contraceptives-app-data-year").html(n[0].survey?n[0].survey_year:2016),this.$app.find(".contraceptives-app-label-small").show())),e=this.data.reasons.filter(function(t){return function(e){return e.code===t.country_code}}(this)),e&&e[0]&&(c=Object.keys(this.reasonsNames).map(function(t){return function(n){return{name:t.reasonsNames[n],value:+e[0][n]}}}(this)),c=c.sort(function(t,e){return e.value-t.value}),s=c[0].name,l=c[0].value),this.setAppItemData(this.$app,p,a,r,h,s,l,this.sentences[this.country_code]),this.pym?this.pym.sendHeight():void 0)},e.prototype.onSelectFilter=function(t){var e;if(t.preventDefault(),this.filter!==$(t.target).attr("href").substring(1))return $("html, body").animate({scrollTop:this.$app.find(".contraceptives-app-filters").offset().top-15},400),this.$app.find(".contraceptives-app-filters .btn").removeClass("active"),e=$(t.target).addClass("active"),this.filter=e.attr("href").substring(1),$(".contraceptives-filter").hide(),this.filterEl=$("#"+this.filter).show(),d3.csv($("body").data("baseurl")+"/data/contraceptives-reasons/"+this.dhs_countries[this.country_code].name+"_"+this.filter_keys[this.filter]+".csv",function(t){return function(e,n){if(n&&(n.forEach(function(e){return t.setAppItemData(t.filterEl.find("#"+t.filter+"-"+e.id),100*(e.n-e.not_using_contraception)/e.n,t.methodsDHSNames[e.most_popular_method],100*e.most_popular_method_n/e.n,100*e.with_unmet_needs/e.n,t.reasonsDHSNames[e.most_popular_reason],100*e.most_popular_reason_n/e.n_reasons)}),t.pym))return t.pym.sendHeight()}}(this))},e.prototype.setAppItemData=function(t,e,n,i,o,a,r,s){return e?(t.find(".contraceptives-app-data-use").html(Math.round(+e)+"%"),t.find(".contraceptives-app-use").show()):t.find(".contraceptives-app-use").hide(),n?(t.find(".contraceptives-app-data-main-method").html(n),t.find(".contraceptives-app-data-main-method-value").html(Math.round(+i)+"%"),t.find(".contraceptives-app-method").show()):t.find(".contraceptives-app-method").hide(),o?(t.find(".contraceptives-app-data-unmetneeds").html(Math.round(+o)+"%"),t.find(".contraceptives-app-unmetneeds").show()):t.find(".contraceptives-app-unmetneeds").hide(),a?(t.find(".contraceptives-app-data-reason").html(a),t.find(".contraceptives-app-data-reason-value").html(Math.round(+r)+"%"),t.find(".contraceptives-app-reason").show()):t.find(".contraceptives-app-reason").hide(),s?t.find(".contraceptives-app-sentence").html(s).show():t.find(".contraceptives-app-sentence").hide()},e}()}.call(this),function(){!function(t){var e,n,i,o,a,r,s,l,c,h,p,u,d,m,f,y,g,v;return v={},c=!1,n=t("body").data("lang"),e=t("body").data("baseurl"),"es"===n&&d3.formatDefaultLocale({currency:["$",""],decimal:",",thousands:".",grouping:[3]}),o=["Female sterilization","Male sterilization","IUD","Implant","Injectable","Pill","Male condom","Female condom","Vaginal barrier methods","Lactational amenorrhea method (LAM)","Emergency contraception","Other modern methods","Any traditional method"],a={es:["esterilización femenina","esterilización masculina","DIU","implante","inyectable","píldora","condón masculino","condón femenino","métodos de barrera vaginal","método de la amenorrea de la lactancia (MELA)","anticonceptivos de emergencia","otros métodos modernos","métodos tradicionales"],en:["female sterilisation","male sterilisation","IUD","implant","injectable","pill","male condom","female condom","vaginal barrier methods","lactational amenorrhea method (LAM)","emergency contraception","other modern methods","traditional methods"]},i={es:{1:"píldora",2:"DIU",3:"inyectable",5:"condón",6:"esterilización femenina",7:"esterilización masculina",8:"abstinencia periódica",9:"marcha atrás",10:"otros",11:"implante",13:"método de la amenorrea de la lactancia (MELA)",17:"métodos tradicionales"},en:{1:"pill",2:"IUD",3:"injectable",5:"condom",6:"female sterilisation",7:"male sterilisation",8:"periodic abstinence",9:"withdrawal",10:"other",11:"implant",13:"lactational amenorrhea method (LAM)",17:"traditional methods"}},l={es:{a:"no están casadas",b:"no tienen sexo",c:"tienen sexo infrecuente",d:"menopausia o esterilización",e:"son subfecundas o infecundas",f:"amenorrea postparto",g:"están dando el pecho",h:"fatalista",i:"la mujer se opone",j:"el marido o la pareja se opone",k:"otros se oponen",l:"prohibición religiosa",m:"no conoce los métodos",n:"no conoce ninguna fuente donde adquirirlos",o:"preocupaciones de salud",p:"miedo a los efectos secundarios/preocupaciones de salud",q:"falta de acceso/muy lejos",r:"cuestan demasiado",s:"inconvenientes para su uso",t:"interfiere con los procesos del cuerpo",u:"el método elegido no está disponible",v:"no hay métodos disponibles",w:"(no estándar)",x:"otros",z:"no lo sé"},en:{a:"not married",b:"not having sex",c:"infrequent sex",d:"menopausal/hysterectomy",e:"subfecund/infecund",f:"postpartum amenorrheic",g:"breastfeeding",h:"fatalistic",i:"respondent opposed",j:"husband/partner opposed",k:"others opposed",l:"religious prohibition",m:"knows no method",n:"knows no source",o:"health concerns",p:"fear of side effects/health concerns",q:"lack of access/too far",r:"costs too much",s:"inconvenient to use",t:"interferes with body's processes",u:"preferred method not available",v:"no method available",w:"(no estándar)",x:"other",z:"don't know"}},s={es:{v3a08a:"no están casadas",v3a08b:"no tienen sexo",v3a08c:"tienen sexo infrecuente",v3a08d:"menopausia o esterilización",v3a08e:"son subfecundas o infecundas",v3a08f:"amenorrea postparto",v3a08g:"están dando el pecho",v3a08h:"fatalista",v3a08i:"la mujer se opone",v3a08j:"el marido o la pareja se opone",v3a08k:"otros se oponen",v3a08l:"prohibición religiosa",v3a08m:"no conoce los métodos",v3a08n:"no conoce ninguna fuente donde adquirirlos",v3a08o:"preocupaciones de salud",v3a08p:"miedo a los efectos secundarios",v3a08q:"falta de acceso/muy lejos",v3a08r:"cuestan demasiado",v3a08s:"inconvenientes para su uso",v3a08t:"interfiere con los procesos del cuerpo"},en:{v3a08a:"not married",v3a08b:"not having sex",v3a08c:"infrequent sex",v3a08d:"menopausal/hysterectomy",v3a08e:"subfecund/infecund",v3a08f:"postpartum amenorrheic",v3a08g:"breastfeeding",v3a08h:"fatalistic",v3a08i:"respondent opposed",v3a08j:"husband/partner opposed",v3a08k:"others opposed",v3a08l:"religious prohibition",v3a08m:"knows no method",v3a08n:"knows no source",v3a08o:"health concerns",v3a08p:"fear of side effects",v3a08q:"lack of access/too far",v3a08r:"costs too much",v3a08s:"inconvenient to use",v3a08t:"interferes with the body's processes"}},u=function(){var e,n,i,o,a,r;return n=0,e=function(){for(a=[],i=0;i<=99;i++)a.push(i);return a}.apply(this),r=d3.select("#contraceptives-use-graph"),r.append("ul").selectAll("li").data(e).enter().append("li").append("svg").append("use").attr("xlink:href","#icon-woman").attr("viewBox","0 0 193 450"),o=function(){var e,i;return n!==r.node().offsetWidth&&(n=r.node().offsetWidth,i=n>480?n/20-10:n/20-4,e=2.33*i,r.selectAll("li").style("width",i+"px").style("height",e+"px"),r.selectAll("svg").attr("width",i).attr("height",e)),r.style("margin-top",.5*(t("body").height()-r.node().offsetHeight)+"px")},new ScrollGraph("contraceptives-use-graph-container",function(t){var e,n,i,o;if(e=+d3.select(t.element).attr("data-step"),e>0)return n=[64,88,100],i=e>1?n[e-2]:0,o=n[e-1],r.selectAll("li").filter(function(t){return t>=i&&t<o}).classed("fill-"+e,"down"===t.direction)}),o(),window.addEventListener("resize",o)},g=function(e,i){var o,a;return o=[],e.forEach(function(t){var e;if(e=i.filter(function(e){return e.code===t.code}),e[0]&&e[0].gni)return o.push({value:+t.estimated,id:e[0].code,name:e[0]["name_"+n],population:+e[0].population,gni:+e[0].gni})}),a=new window.BeeswarmScatterplotGraph("unmet-needs-gdp-graph",{margin:{left:0,rigth:0,top:5,bottom:0},key:{x:"gni",y:"value",id:"id",label:"name",color:"value",size:"population"},dotMinSize:1,dotMaxSize:32}),a.setData(o),new ScrollGraph("unmet-needs-gdp-container-graph",function(t){var e;return e=+d3.select(t.element).attr("data-step"),a.setMode(e)}),t(window).resize(a.onResize)},p=function(e,i,r){var s;return e.forEach(function(t){var e;if(e=i.filter(function(e){return e.code===t.code}),t.values=[],t.value=0,o.forEach(function(e,i){return t.values.push({id:i,name:a[n][i],value:""!==t[e]?+t[e]:null})}),e&&e[0])return t.name=e[0]["name_"+n],t.code_num=e[0].code_num}),s=new window.ContraceptivesUseMapGraph("map-contraceptives-use",{aspectRatio:.5625,margin:{top:60,bottom:0},legend:!0,lang:n}),s.setData(e,r),new ScrollGraph("contraceptives-use-container",function(t){var e;return e=+d3.select(t.element).attr("data-step"),s.setMapState(e)}),s.onResize(),t(window).resize(s.onResize)},d=function(e){var i;return i=new window.ContraceptivesUseTreemapGraph("treemap-contraceptives-use",{aspectRatio:.5625,margin:{left:0,rigth:0,top:0,bottom:0},key:{value:"value",id:"name"},methodsKeys:o,methodsNames:a[n]}),i.setData(e,v.code,v.name),new ScrollGraph("treemap-contraceptives-use-container",function(t){var e;return e=+d3.select(t.element).attr("data-step"),1===e?i.updateData("world","Mundo"):0===e&&"up"===t.direction?i.updateData(v.code,v.name):void 0}),t(window).resize(i.onResize)},y=function(){var e;return e=t("#contraceptives-reasons-opposed .bar"),t("#contraceptives-reasons-opposed-legend li").mouseover(function(){return e.addClass("disabled").filter(".bar-"+t(this).attr("class")).removeClass("disabled")}).mouseout(function(){return e.removeClass("disabled")})},r=function(t){var e;return e=d3.select(t.element).attr("data-step"),this.graphic.selectAll(".active").classed("active",!1),this.graphic.select(".step-"+e).classed("active",!0)},f=function(){var e,n;return e=[{1990:385,1995:369,2000:341,2005:288,2010:246,2015:216}],n=new window.LineGraph("maternal-mortality-graph",{isArea:!0,margin:{left:20}}),n.xAxis.tickValues([1995,2005,2015]),n.yAxis.tickValues([100,200,300]).tickFormat(d3.format(".0s")),n.yFormat=d3.format(".2s"),n.getScaleYDomain=function(){return[0,385]},n.setData(e),t(window).resize(n.onResize)},h=function(t,e){var i;if(t?(i=e.filter(function(e){return e.code2===t.country_code}),i[0]&&(v.code=i[0].code,v.name=i[0]["name_"+n])):t={},!t.code)return v.code="ESP",v.name="es"===n?"España":"Spain"},m=function(e,c,h,m,f){if(h.forEach(function(t){var e;if(e=m.filter(function(e){return e.code2===t.code}),e&&e[0])return t.code=e[0].code,t.name=e[0]["name_"+n],Object.keys(l[n]).forEach(function(e){t[e]=100*t[e],t[e]>100}),delete t.country}),t("#treemap-contraceptives-use").length&&d(e),t("#map-contraceptives-use").length&&p(e,m,f),t("#contraceptives-use-graph").length>0&&u(),t("#unmet-needs-gdp-graph").length&&g(c,m),t("#carousel-marie-stopes").length&&new ScrollGraph("carousel-marie-stopes",r),t("#contraceptives-reasons-opposed").length&&y(),t("#contraceptives-app").length)return new ContraceptivesApp(n,e,c,h,v,o,a[n],i[n],l[n],s[n])},t("body").hasClass("datos-uso-barreras")||t("body").hasClass("data-use-barriers")?d3.json("https://freegeoip.net/json/",function(t,n){return d3.queue().defer(d3.csv,e+"/data/contraceptives-use-countries.csv").defer(d3.csv,e+"/data/unmet-needs.csv").defer(d3.csv,e+"/data/contraceptives-reasons.csv").defer(d3.csv,e+"/data/countries-gni-population-2016.csv").defer(d3.json,e+"/data/map-world-110.json").await(function(t,e,i,o,a,r){return h(n,a),m(e,i,o,a,r)})}):t("body").hasClass("religion")&&(t("#carousel-rabinos").length&&new ScrollGraph("carousel-rabinos",r),t("#carousel-imam").length&&new ScrollGraph("carousel-imam",r),t("#carousel-papa").length&&new ScrollGraph("carousel-papa",r),t("#maternal-mortality-graph").length)?f():void 0}(jQuery)}.call(this);