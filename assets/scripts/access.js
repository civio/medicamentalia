function patents_graph(t){var e,a,i,n,r,o,l,s=jQuery.noConflict(),c=this,d=t,u=s(d),f=u.data("lang"),p={es:"Se aprueba la licencia obligatoria",en:"Compulsory license is approved"},h={top:20,right:0,bottom:20,left:0},y=1140,g=500;c.init=function(){return y=u.width(),g=.5625*y,e=y-h.left-h.right,a=g-h.top-h.bottom,n=d3.scaleBand().range([0,e]).round(!0).paddingInner(.1).paddingOuter(0),r=d3.scaleLinear().range([a,0]),o=d3.axisBottom().scale(n),l=d3.line().x(function(t){return n(t.date)}).y(function(t){return r(t.patents)}),i=d3.select(d).append("svg").attr("id","patents-graph-svg").attr("width",y).attr("height",g).append("g").attr("transform","translate("+h.left+","+h.top+")"),d3.csv(s("body").data("baseurl")+"/data/patents.csv",function(t,e){e.forEach(function(t){t.patents=+t.patents}),n.domain(e.map(function(t){return t.date})),r.domain([0,d3.max(e,function(t){return t.patents})]),i.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(d3.axisBottom(n)),i.append("line").attr("class","marker").attr("x1",function(t){return n(2007)}).attr("y1",a).attr("x2",function(t){return n(2007)}).attr("y2",a),i.append("g").attr("class","marker-label").append("text").attr("x",function(t){return n(2007)}).text(p[f]),i.selectAll(".bar").data(e).enter().append("rect").attr("class","bar").attr("x",function(t){return n(t.date)}).attr("y",a).attr("height",0).attr("width",n.bandwidth()),i.selectAll(".bar-label").data(e).enter().append("text").attr("class","bar-label").attr("x",function(t){return n(t.date)+.5*n.bandwidth()}).attr("y",function(t){return r(t.patents)}).attr("dy","1.5em").text(function(t){return t.patents}),d3.selectAll(".bar").transition().duration(800).delay(function(t,e){return 100*e}).attr("y",function(t){return r(t.patents)}).attr("height",function(t){return a-r(t.patents)}),d3.select(".marker").transition().duration(600).delay(1500).attr("y1",0)}),c},c.onResize=function(){return y=u.width(),g=.5625*y,e=y-h.left-h.right,a=g-h.top-h.bottom,m(),c};var m=function(){d3.select("#patents-graph-svg").attr("width",y).attr("height",g),n.range([0,e]),r.range([a,0]),d3.select("g.x.axis").attr("transform","translate(0,"+a+")").call(d3.axisBottom(n)),d3.select(".marker-label text").attr("x",function(t){return n(2007)}),d3.selectAll(".bar").attr("x",function(t){return n(t.date)}).attr("y",function(t){return r(t.patents)}).attr("width",n.bandwidth()).attr("height",function(t){return a-r(t.patents)}),d3.selectAll(".bar-label").attr("x",function(t){return n(t.date)+.5*n.bandwidth()}).attr("y",function(t){return r(t.patents)}),d3.select(".marker").attr("x1",function(t){return n(2007)}).attr("x2",function(t){return n(2007)}).attr("y2",a)};return c}function Prices_Infographic(t){var e,a,i,n,r,o,l,s,c,d,u,f,p,h,y,g,m,b,v,x,A,w,C,k,B,D,I,M,P,S=jQuery.noConflict(),L=this,z=!1,T=7,R={data:"affordability",type:"private",order:"area",label:"Private sector - number of days"},_={es:{gratis:"gratis",dias:"Días",horas:"horas",menoshora:"menos de una hora",Africa:"África",America:"América",Asia:"Asia",Europe:"Europa",Oceania:"Oceanía","Low income":"Ingreso bajo","Lower middle income":"Ingreso medio bajo","Upper middle income":"Ingreso medio alto","High income":"Ingreso alto"},en:{gratis:"free",dias:"Days",horas:"hours",menoshora:"less than an hour",Africa:"Africa",America:"America",Asia:"Asia",Europe:"Europe",Oceania:"Oceania","Low income":"Low income","Lower middle income":"Lower middle income","Upper middle income":"Upper middle income","High income":"High income"}},O=null,G=null,E={top:150,right:50,bottom:50,left:50},F=t,N=S(F),V=S("#prices-infographic-menu"),j=S("#prices-infographic-tooltip"),U=S("#region-dropdown-menu .checkbox input"),K=S("#drug-dropdown-menu .checkbox input"),Q=N.parent().data("lang"),H=d3.scaleOrdinal().range(["#C9AD4B","#BBD646","#63BA2D","#34A893","#3D91AD","#5B8ACB","#BA7DAF","#BF6B80","#F49D9D","#E25453","#B56631","#E2773B","#FFA951","#F4CA00"]),W=function(t){return 0===t?_[Q].gratis:t+"x"},q=function(t){return 0===t?_[Q].gratis:t};L.init=function(t){return z=!0,L.skip=t,kt(),o=d3.scalePoint().range([0,i]),l=d3.scalePow().exponent(.5).range([n,0]),s=d3.axisBottom(o).tickSize(-n).tickPadding(12),c=d3.axisLeft(l).tickSize(-i).tickPadding(8).tickFormat(q),r=d3.select(F).append("svg").attr("id","prices-infographic-svg").attr("width",e).attr("height",a).append("g").attr("transform","translate("+E.left+","+E.top+")"),p="",K.each(function(){p+=S(this).attr("name")+" "}),f=p,d3.queue().defer(d3.csv,S("body").data("baseurl")+"/data/prices.csv").defer(d3.csv,S("body").data("baseurl")+"/data/affordability.csv").defer(d3.csv,S("body").data("baseurl")+"/data/prices-countries.csv").await(J),L},L.setState=function(t){if(0===t)f=p,Y("affordability","private"),x.transition(1e3).style("fill",function(t){return"Salbutamol"!==t.Drug?"#d6d6d6":H(t.Drug)}).style("opacity",function(t){return"Salbutamol"!==t.Drug?.7:1}),x.sort(function(t,e){return"Salbutamol"===t.Drug?1:-1}),rt(".dot.drug-salbutamol.country-kyrgyzstan");else if(1===t)f=p,Y("affordability","private"),Bt(),rt(".dot.drug-captopril.country-ghana");else if(2===t)f="Simvastatin Omeprazole",Y("affordability","private"),x.transition(1e3).style("fill",function(t){return f.indexOf(t.Drug)===-1?"#d6d6d6":H(t.Drug)}).style("opacity",function(t){return f.indexOf(t.Drug)===-1?.7:1}),x.sort(function(t,e){return f.indexOf(t.Drug)>-1?1:-1}),rt(".dot.drug-simvastatin.country-são-tomé-and-príncipe");else if(3===t){f=p;var e="São Tomé and Príncipe Kuwait Italy Spain Germany";Y("affordability","private"),x.transition(1e3).style("fill",function(t){return e.indexOf(t.Country)===-1?"#d6d6d6":H(t.Drug)}).style("opacity",function(t){return e.indexOf(t.Country)===-1?.7:1}),rt(".dot.drug-ciprofloxacin.country-são-tomé-and-príncipe")}else 4===t?(f=p,Y("prices","private"),Bt(),rt(".dot.drug-ciprofloxacin.country-morocco")):5===t?(f=p,Y("prices","private"),x.transition(1e3).style("fill","#d6d6d6").style("opacity",.7),r.selectAll(".dot.country-kuwait").transition(1e3).style("fill",function(t){return H(t.Drug)}).style("opacity",1),rt(".dot.drug-ciprofloxacin.country-kuwait")):6===t?(f=p,Y("prices","public"),Bt(),rt(".dot.drug-diclofenac.country-sudan")):7===t?(f=p,Y("prices","public"),Bt(),rt(".dot.drug-amoxicillin.country-brazil--rio-grande-do-sul-state")):8===t?(f=p,Y("prices","private"),x.transition(1e3).style("fill",function(t){return"Ciprofloxacin"!==t.Drug?"#d6d6d6":H(t.Drug)}).style("opacity",function(t){return"Ciprofloxacin"!==t.Drug?.7:1}),x.sort(function(t,e){return"Ciprofloxacin"===t.Drug?1:-1}),rt(".dot.drug-ciprofloxacin.country-ethiopia")):9===t&&(f=p,Y("affordability","private"),j.css("opacity","0"),u=null,Bt());return L},L.resize=function(){if(kt(),e<860||n<0)return L;if(v.attr("width",e).attr("height",a),o.range([0,i]),l.range([n,0]),s.tickSize(-n),c.tickSize(-i),I.attr("transform","translate(0,"+n+")").call(s),D.call(c),w.attr("y1",n),C.attr("y",n+36),B.attr("transform","translate(0 "+l(1)+")"),B.selectAll("line").attr("x2",i),k.attr("width",i).attr("height",n),u){j.hasClass("left")?j.css("right",e-Math.round(u.attr("cx"))-E.left+"px"):j.css("left",Math.round(u.attr("cx"))+E.left+"px");var t=Math.round(u.attr("cy"));t>60?j.css("top",t+E.top-8-.5*j.height()+"px"):j.css("top",t+E.top-18+"px")}return A.selectAll("line").attr("x1",gt).attr("y1",n).attr("x2",gt).attr("y2",mt),x.attr("cx",gt).attr("cy",mt),e<960&&7===T?(T=6,x.attr("r",T)):e>=960&&6===T&&(T=7,x.attr("r",T)),L},L.isInitialized=function(){return z};var J=function(t,e,a,i){if(t)throw t;e=e.filter(function(t){return"MPR"===t["Unit/MPR"]}),e.forEach(function(t){t.Price="NO DATA"===t.Price?null:"free"!==t.Price?+t.Price:0}),a.forEach(function(t){var e=t["Public sector - number of days"],a=t["Private sector - number of days"];t["Public sector - number of days"]="NO DATA"!==e&&""!==e?+e:null,t["Private sector - number of days"]="NO DATA"!==a&&""!==a?+a:null}),m=b=i,h=e.filter(function(t){return"Public"===t["Public/Private"]}),y=e.filter(function(t){return"Private"===t["Public/Private"]}),g=a,tt(),e=a=i=null,Z(),X(),L.skip&&L.setState(9)},Z=function(){var t=xt();v=d3.select("#prices-infographic-svg"),V.find("."+R.data+"-"+R.type).show(),o.domain(m.map(function(t){return t.Code})),l.domain(d3.extent(t,function(t){return t[R.label]})).nice(),H.domain(d3.extent(t,function(t){return t.Drug})),s.ticks(m.length),I=r.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")").call(s),D=r.append("g").attr("class","y axis").call(c),M=D.append("text").attr("class","y-label").attr("y",-15).style("text-anchor","end").text(_[Q].dias),w=r.append("line").attr("class","country-marker").attr("x1",0).attr("y1",n).attr("x2",0).attr("y2",0).style("opacity",0),C=r.append("text").attr("class","country-label").attr("y",n+36).style("opacity",0),B=r.append("g").attr("class","mpr-line").style("opacity",0).attr("transform","translate(0 "+l(1)+")"),B.append("line").attr("x1",0).attr("y1",0).attr("x2",i).attr("y2",0),B.append("text").attr("x",-8).attr("y",0).attr("dy","0.32em").text("MPR"),k=r.append("rect").attr("class","overlay").style("opacity",0).attr("width",i).attr("height",n),r.append("g").attr("class","dots").selectAll(".dot").data(t).enter().append("circle").attr("id",pt).attr("class",function(t){return"dot"+yt(t)}).attr("r",T).attr("cx",gt).attr("cy",mt).style("visibility",bt).style("opacity",.7).style("fill",vt),x=d3.selectAll(".dot"),A=r.append("g").attr("class","dot-lines"),Ct(!0),k.on("mouseout",ct).on("mousemove",st).on("click",dt),x.on("mouseover",it).on("mouseout",ot)},Y=function(t,e){if(t=void 0!==t&&t,e=void 0!==e&&e,t&&e){if(R.data===t&&R.type===e)return L;R.data=t,R.type=e}else R.data=S("#mpr-btn").hasClass("active")?"prices":"affordability",R.type=S("#public-btn").hasClass("active")?"public":"private";if(!z)return L;R.label="prices"===R.data?"Price":"public"===R.type?"Public sector - number of days":"Private sector - number of days",dt(),t&&e||(V.find("h4").hide(),V.find("."+R.data+"-"+R.type).show());var a,i=xt();return"prices"===R.data?(c.tickFormat(W),d3.select(".y-label").transition().duration(1e3).style("opacity",0)):(c.tickFormat(q),d3.select(".y-label").transition().duration(1e3).style("opacity",1)),l.domain(d3.extent(i,function(t){return t[R.label]})).nice(),D.transition().duration(1e3).ease(d3.easeSinInOut).call(c),"prices"===R.data?B.transition().duration(1e3).attr("transform","translate(0 "+l(1)+")").style("opacity",1):B.transition().duration(1e3).style("opacity",0),x.style("visibility","hidden"),i.forEach(function(t){a=r.select(".dot"+ht(t)),a.empty()?d3.select(".dots").append("circle").datum(t).attr("id",pt).attr("class",function(t){return"dot"+yt(t)}).attr("r",T).attr("cx",gt).attr("cy",mt).style("visibility",bt).style("opacity",.7).style("fill",vt).on("mouseover",it).on("mouseout",ot):a.datum(t).style("visibility",bt).transition().duration(1e3).attr("cx",gt).attr("cy",mt)}),x=d3.selectAll(".dot"),L},X=function(){S("#mpr-btn, #affordability-btn").click(function(t){S(this).hasClass("active")||(S("#mpr-btn, #affordability-btn").removeClass("active"),S(this).addClass("active"),Y())}),S("#public-btn, #private-btn").click(function(t){S(this).hasClass("active")||(S("#public-btn, #private-btn").removeClass("active"),S(this).addClass("active"),Y())}),S("#area-btn, #pib-btn").click(function(t){S(this).hasClass("active")||(S("#area-btn, #pib-btn").removeClass("active"),S(this).addClass("active"),$())}),U.change(function(t){et()}),K.change(at)},$=function(){R.order=S("#area-btn").hasClass("active")?"area":"pib","area"===R.order?tt():m.sort(function(t,e){return d3.ascending(+t.PIB,+e.PIB)}),dt(),o.domain(m.map(function(t){return t.Code})),P.fadeOut(),setTimeout(Ct,1200);var t=r.transition().duration(1e3);return t.selectAll(".dot").attr("cx",gt),t.select(".x.axis").call(s).selectAll("g"),L},tt=function(){m.sort(function(t,e){return t.Area===e.Area?d3.ascending(t["Country_"+Q],e["Country_"+Q]):d3.ascending(t.Area,e.Area)})},et=function(t){var e="";t?e=t:(U.each(function(){S(this).is(":checked")&&(e+=S(this).attr("name")+" ")}),""===e&&U.each(function(){S(this).attr("checked",!0),e+=S(this).attr("name")+" "})),m=b.filter(function(t){return e.indexOf(t.Area)>-1}),"pib"===R.order&&m.sort(function(t,e){return d3.ascending(+t.PIB,+e.PIB)}),P.fadeOut(),setTimeout(Ct,1200),o.domain(m.map(function(t){return t.Code})),x.style("visibility",bt),dt();var a=r.transition().duration(1e3);a.selectAll(".dot").attr("cx",gt),a.select(".x.axis").call(s).selectAll("g")},at=function(){f="","All"===S(this).attr("name")?S(this).attr("checked")?K.each(function(){S(this).attr("checked",!0)}):(K.each(function(){S(this).attr("checked",!1)}),K.filter('[name="Amitriptyline"]').attr("checked",!0)):S(this).attr("checked")&&K.filter(":checked").length===K.length-1?K.filter('[name="All"]').attr("checked",!0):K.filter('[name="All"]').attr("checked",!1),K.each(function(){S(this).is(":checked")&&(f+=S(this).attr("name")+" ")}),""===f&&(f=p,K.each(function(){S(this).attr("checked",!0)})),dt(),x.style("visibility",bt)},it=function(){var t=d3.select(this);x.on("click",lt),x.style("fill",function(t){return d3.select(this).attr("id")!==G?"#d6d6d6":H(t.Drug)}).style("opacity",function(t){return d3.select(this).attr("id")!==G?.7:1}),r.selectAll(".dot.drug-"+t.attr("id")).style("fill",function(t){return H(t.Drug)}).style("opacity",1);var e=xt();e=e.filter(function(e){return ut(e.Drug)===t.attr("id")}),null===G&&A.selectAll(".line").data(e).enter().append("line").attr("id",pt).attr("class",function(t){return"line"+yt(t)}).attr("x1",gt).attr("y1",n).attr("x2",gt).attr("y2",mt).style("visibility",bt).style("stroke",vt);var a=d3.mouse(this)[0],l=i/(o.domain().length-1),s=Math.round(a/l);I.selectAll(".tick:nth-child("+(s+2)+") text").attr("class","active"),C.style("opacity",1),x.sort(function(e,a){return t.attr("id")===ut(e.Drug)?1:-1}),nt(t)},nt=function(t){if(t=u?u:t){var a=+t.data()[0][R.label],n="prices"!==R.data?"glyphicon-time":a<1?"glyphicon-arrow-down":"glyphicon-arrow-up";if(j.find(".country").html(At(t.data()[0].Country)[0]["Region_"+Q]),j.find(".year").html("("+t.data()[0].Year+")"),j.find(".drug, .green .glyphicon, .green .txt").hide(),j.find(".drug-"+t.data()[0].Drug.toLowerCase()).show(),j.find(".green ."+n).show(),0!==a?(j.find(".price").html(ft(a)),j.find(".green ."+R.data+"-txt").show()):j.find(".price").html("gratis"),"prices"!==R.data&&a<1&&0!==a){var r=Math.round(8*a);r>0?j.find(".affordability-txt-hour").html("  ("+r+" "+_[Q].horas+")").show():j.find(".affordability-txt-hour").html("  ("+_[Q].menoshora+")").show()}var o=t.attr("cx")>.5*i,l=Math.round(t.attr("cy"));o?j.addClass("left").css({right:e-Math.round(t.attr("cx"))-E.left+"px",left:"auto"}):j.removeClass("left").css({right:"auto",left:Math.round(t.attr("cx"))+E.left+"px"}),l>60?j.removeClass("top").css({top:l+E.top-8-.5*j.height()+"px",opacity:"1"}):j.addClass("top").css({top:l+E.top-18+"px",opacity:"1"})}},rt=function(t){j.css("opacity","0"),u=d3.select(t),clearTimeout(d),d=setTimeout(nt,1200)},ot=function(){x.on("click",null),null===G?(x.style("fill",function(t){return H(t.Drug)}).style("opacity",.7),A.selectAll("*").remove()):x.style("fill",function(t){return d3.select(this).attr("id")!==G?"#d6d6d6":H(t.Drug)}).style("opacity",function(t){return d3.select(this).attr("id")!==G?.7:1}),j.css({opacity:"0",right:"auto",left:"-1000px"})},lt=function(){var t=d3.select(this).attr("id");G=t!==G?t:null},st=function(){var t=d3.mouse(this)[0],e=i/(o.domain().length-1),a=Math.round(t/e);if(O===a)return L;O=o.domain()[a],w.style("opacity",1).attr("transform","translate("+o(O)+" 0)");var n=m.filter(function(t){return t.Code===O});I.selectAll(".tick text").attr("class",""),I.selectAll(".tick:nth-child("+(a+2)+") text").attr("class","active"),C.attr("x",o(O)).style("opacity",1).text(n[0]["Country_"+Q])},ct=function(){O=null,w.style("opacity",0),C.style("opacity",0),I.selectAll(".tick text").attr("class","")},dt=function(){null!==G&&(G=null,A.selectAll("*").remove(),x.style("fill",function(t){return H(t.Drug)}).style("opacity",.7))},ut=function(t){return t.toLowerCase().replace(/[ +,\/]/g,"-")},ft=function(t){return"es"!==Q?t.toFixed(2):t.toFixed(2).toString().replace(/\./g,",")},pt=function(t){return ut(t.Drug)},ht=function(t){return".country-"+ut(t.Country)+".drug-"+ut(t.Drug)},yt=function(t){return" country-"+ut(t.Country)+" drug-"+ut(t.Drug)},gt=function(t){var e=At(t.Country);return e.length>0?o(e[0].Code):0},mt=function(t){return null!==t[R.label]?l(t[R.label]):n},bt=function(t){return null!==t[R.label]&&f.indexOf(t.Drug)>-1&&m.some(function(e){return e.Region_en===t.Country})?"visible":"hidden"},vt=function(t){return H(t.Drug)},xt=function(){return"affordability"===R.data?g:"public"===R.type?h:y},At=function(t){return m.filter(function(e){return e.Region_en===t})},wt=function(t){return m.filter(function(e){return e.Code===t})},Ct=function(t){var e,a,n=null,r=null,l=0;t?(P=S('<ul class="x-area"></ul>'),N.append(P)):(P.find("li").remove(),P.fadeIn()),e="area"===R.order?"Area":"PIB_Area",d3.selectAll(".x.axis .tick text").each(function(t){r=wt(t),r[0]&&n!==r[0][e]&&(n=r[0][e],P.find("li").last().css("width",100*(o(r[0].Code)-l)/i+"%"),l=o(r[0].Code),a=S("<li>"+_[Q][n]+"</li>"),P.append(a))}),P.find("li").last().css("width",100*(o(r[0].Code)-l)/i+"%")},kt=function(){e=N.width(),a=N.height(),i=e-E.left-E.right,n=a-E.top-E.bottom},Bt=function(){x&&x.transition(1e3).style("fill",function(t){return H(t.Drug)}).style("opacity",.7)};return L}var Infographic=function(t,e){var a,i,n,r,o,l,s,c=jQuery.noConflict(),d=this,u=t,f=e,p=-1,h=function(){s.each(function(t){c(this).append('<div class="btn-next"><a href="#'+(t+2)+'" class="btn btn-default btn-sm">Siguiente <i class="glyphicon glyphicon-chevron-right"></i></a></div>')}),s.find(".btn-next a").click(function(t){t.preventDefault(),c("html, body").animate({scrollTop:c(".infographic-frame li.frame-"+c(this).attr("href").substring(1)).offset().top+2},"200")}),c("html, body").animate({scrollTop:c(".infographic-frame li.frame-1").offset().top+2},"200")},y=function(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null==e?null:e[1]||0};d.init=function(){o=c(u),s=o.find(".infographic-content li"),r=o.find(".infographic-nav li"),"prices"===f&&(o.find(".infographic-frame").append('<li class="frame-'+(r.length+1)+'"><div class="scroller"></div></li>').append('<li class="frame-'+(r.length+2)+'"><div class="scroller"></div></li>'),o.hasClass("iframe")&&o.find(".infographic-nav").append('<li><a href="#'+(r.length+1)+'"></a></li>')),l=o.find(".infographic-content, .infographic-nav, .infographic-graph"),"antimalaricos"===f?a=new Antimalaricos_Infographic(u+" .infographic-graph").init():"fakes"===f?a=new Fakes_Infographic(u+" .infographic-graph").init():"patentes"===f?a=new Patents_Infographic(u+" .infographic-graph").init():"prices"===f&&(a=new Prices_Infographic(u+" .infographic-graph")),d.onResize(),"prices"===f&&(a.init("true"===y("skip")),o.hasClass("iframe")&&(a.skip?(c("#prices-infographic .infographic-frame").hide(),c("#prices-infographic-menu").addClass("active"),o.find(".infographic-nav, .infographic-content").addClass("invisible"),s.not(".active").css("top","-40px"),s.filter(".active").css("top","40px").removeClass("active")):h())),s.first().addClass("active"),r.find("a").click(function(t){t.preventDefault(),c("html, body").animate({scrollTop:o.find(".infographic-frame li.frame-"+c(this).attr("href").substring(1)).offset().top+2},"200")})},d.onScroll=function(t){i=c(window).scrollTop(),i>=o.offset().top&&i<n?(l.addClass("fixed"),"prices"===f&&c("#prices-infographic-tooltip").addClass("fixed")):(l.removeClass("fixed"),"prices"===f&&c("#prices-infographic-tooltip").removeClass("fixed")),i>=n?l.addClass("bottom"):l.removeClass("bottom");var e=p,d=Math.floor((i-o.offset().top)/c(window).height());p!==d&&(p=d)>=0&&("prices"===f&&(p!==s.length?(c("#prices-infographic-menu").removeClass("active"),o.find(".infographic-nav, .infographic-content").removeClass("invisible")):(c("#prices-infographic-menu").addClass("active"),o.find(".infographic-nav, .infographic-content").addClass("invisible"))),a.setState(p),e<p?(s.not(".active").css("top","40px"),s.filter(".active").css("top","-40px").removeClass("active")):(s.not(".active").css("top","-40px"),s.filter(".active").css("top","40px").removeClass("active")),s.eq(p).css("top","0px").addClass("active"),r.removeClass("active"),r.eq(p).addClass("active"))},d.onResize=function(){o.find(".infographic-content, .infographic-nav, .infographic-frame li").height(c(window).height()),o.find(".infographic-graph").height(c(window).height()-c(".infographic-graph").position().top-30),n=o.offset().top+o.height()-c(window).height(),c(window).width()<860&&o.find(".infographic-content").css("height","auto"),"prices"===f&&a.isInitialized()&&a.resize()},d.init()},Antimalaricos_Infographic=function(t){var e,a=jQuery.noConflict(),i=this,n=t;i.init=function(){return d3.xml(a("body").data("baseurl")+"/images/svg/antimalaricos.svg").mimeType("image/svg+xml").get(function(t){a(n).append(t.documentElement),e=d3.select(n).select("svg"),e.selectAll("#Bubble1, #Bubble2, #Bubble3, #Brasil, #Bolivia, #Venezuela, #World, #India, #PathIndia, #Ginebra").style("opacity",0),e.select("#Markers").selectAll("image").style("opacity",0),e.select("#MarkersIndia").selectAll("image").style("opacity",0)}),i},i.setState=function(t){return 0===t?(o("#Bubble2"),e.selectAll("#Brasil").transition().duration(1e3).style("opacity",1),r("#Bubble1")):1===t?(o("#Bubble1"),s("#Markers"),e.selectAll("#Brasil, #Bolivia, #Venezuela").transition().duration(300).style("opacity",0),r("#Bubble2")):2===t?(o("#Bubble2"),s("#Markers"),s("#MarkersIndia"),e.selectAll("#Brasil, #Bolivia, #Venezuela, #World, #India, #PathIndia").transition().duration(300).style("opacity",0),e.selectAll("#Continent, #Brasil, #Bolivia, #Venezuela").transition().duration(500).delay(function(t,e){return 300*e}).style("opacity",1),l("#Markers",200,300)):3===t?(o("#Bubble3"),s("#Markers"),s("#MarkersIndia"),e.selectAll("#Continent, #Brasil, #Bolivia, #Venezuela, #Ginebra").transition().duration(300).style("opacity",0),e.select("#World").transition().duration(1e3).style("opacity",1),e.select("#India").transition().duration(500).delay(2e3).style("opacity",1),l("#MarkersIndia",600,900),e.select("#PathIndia").style("opacity",1),e.select("#PathIndia").select("#SVGID_antimalaricos_1_").attr("transform","scale(0 1)").transition().duration(1500).delay(800).attr("transform","scale(1 1)")):4===t&&(s("#MarkersIndia"),e.selectAll("#India, #PathIndia").transition().duration(300).style("opacity",0),e.select("#Ginebra").transition().duration(400).style("opacity",1),r("#Bubble3")),i};var r=function(t){var a=e.select(t).node().getBBox();e.select(t).attr("transform","translate("+(a.x+.5*a.width)+" "+(a.y+.5*a.height)+") scale(0.8) translate(-"+(a.x+.5*a.width)+" -"+(a.y+.5*a.height)+")").transition().duration(400).delay(300).attr("transform","translate(0 0) scale(1)").style("opacity",1)},o=function(t){var a=e.select(t).node().getBBox();e.select(t).transition().duration(400).attr("transform","translate("+(a.x+.5*a.width)+" "+(a.y+.5*a.height)+") scale(0.8) translate(-"+(a.x+.5*a.width)+" -"+(a.y+.5*a.height)+")").style("opacity",0)},l=function(t,a,i){e.select(t).selectAll("image").transition().duration(500).delay(function(t,e){return a+i*e}).style("opacity",1)},s=function(t){e.select(t).selectAll("image").transition().duration(300).style("opacity",0)};return i},Fakes_Infographic=function(t){var e,a=jQuery.noConflict(),i=this,n=t,r=-1;i.init=function(){return d3.xml(a("body").data("baseurl")+"/images/svg/fakes.svg").mimeType("image/svg+xml").get(function(t){a(n).append(t.documentElement),e=d3.select(n).select("svg"),e.selectAll("#Continents, #Path, #LomeLabel, #LomeMarker, #MumbaiLabel, #MumbaiMarker, #IndiaMarker, #IndiaLabel").style("opacity",0),e.select("#AfricanCountries").selectAll("path").style("opacity",0)}),i},i.setState=function(t){if(0===t)e.selectAll("#Path, #MumbaiMarker, #MumbaiLabel, #LomeMarker, #LomeLabel").transition().duration(200).style("opacity",0),1===r&&(l("#Continents",400),o("#India",600)),e.selectAll("#IndiaMarker, #IndiaLabel").transition().duration(300).delay(function(t,e){return 400+300*e}).style("opacity",1);else if(1===t){e.selectAll("#IndiaMarker, #IndiaLabel").transition().duration(200).style("opacity",0),e.select("#AfricanCountries").selectAll("path").transition().duration(200).style("opacity",0),l("#India",400),0===r&&o("#Continents",600),e.selectAll("#MumbaiMarker, #MumbaiLabel").transition().duration(300).delay(function(t,e){return 500+300*e}).style("opacity",1),e.selectAll("#LomeMarker, #LomeLabel").transition().duration(300).delay(function(t,e){return 1800+300*e}).style("opacity",1),e.select("#Path").style("opacity",1);var a=e.select("#Path").select("#SVGID_1_").attr("width");e.select("#Path").select("#SVGID_1_").attr("transform","translate("+a+" 0)").transition().duration(1500).delay(600).attr("transform","translate(0 0)")}else 2===t&&(e.selectAll("#Path, #MumbaiMarker, #MumbaiLabel, #LomeMarker, #LomeLabel").transition().duration(200).style("opacity",0),e.select("#AfricanCountries").selectAll("path").transition().duration(500).delay(function(t,e){return 300*e}).style("opacity",1));return r=t,i};var o=function(t,a){var i=e.select(t).node().getBBox();e.select(t).attr("transform","translate("+(i.x+.5*i.width)+" "+(i.y+.5*i.height)+") scale(0.9) translate(-"+(i.x+.5*i.width)+" -"+(i.y+.5*i.height)+")").transition().duration(a).attr("transform","translate(0 0) scale(1)").style("opacity",1)},l=function(t,a){var i=e.select(t).node().getBBox();e.select(t).transition().duration(a).attr("transform","translate("+(i.x+.5*i.width)+" "+(i.y+.5*i.height)+") scale(0.9) translate(-"+(i.x+.5*i.width)+" -"+(i.y+.5*i.height)+")").style("opacity",0)};return i},Patents_Infographic=function(t){var e,a=jQuery.noConflict(),i=this,n=t,r=-1,o=41,l=["Albania","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Bahrain","Bangladesh","Barbados","Belgium","Belize","Benin","Bolivia","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Congo","Costa Rica","Côte d'Ivoire","Croatia","Cuba","Cyprus","Czech Republic","D.R. Congo","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Estonia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kenya","Korea","Kuwait","Kyrgyz Republic","Lao P.D.R","Latvia","Lesotho","Liechtenstein","Lithuania","Luxembourg","Macao","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Mauritania","Mauritius","Mexico","Moldova","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","Norway","Oman","Pakistan","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Rwanda","Saint Kitts & Nevis","Saint Lucia","Saint Vincent & the Grenadines","Samoa","Saudi Arabia","Senegal","Seychelles","Sierra Leone","Singapore","Slovak Republic","Slovenia","Solomon Islands","South Africa","Spain","Sri Lanka","Suriname","Swaziland","Sweden","Switzerland","Chinese Taipei","Tajikistan","Tanzania","Thailand","Macedonia","Togo","Tonga","Trinidad & Tobago","Tunisia","Turkey","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States of America","Uruguay","Vanuatu","Venezuela","Viet Nam","Yemen","Zambia","Zimbabwe"];i.init=function(){return d3.xml(a("body").data("baseurl")+"/images/svg/patentes.svg").mimeType("image/svg+xml").get(function(t){a(n).append(t.documentElement),e=d3.select(n).select("svg"),e.selectAll("#World, #Doc1, #Doc2").style("opacity",0),e.selectAll("#Chemistry, #Time").selectAll("g").style("opacity",0),e.selectAll("#Sign").selectAll("g").style("opacity",function(t,e){return e<4?0:1}),l=d3.shuffle(l),e.select("#World").selectAll("text").style("text-anchor",function(t,e){return e<21?"end":"start"}).text(function(t,e){return l[e]}).style("opacity",0).transition().delay(function(t,e){return 100*e}).on("start",function t(){o>=l.length&&(o=0),d3.active(this).style("opacity",0).text(l[o++]).transition().duration(1800).style("opacity",1).transition().duration(900).style("opacity",0).transition().on("start",t)})}),i},i.setState=function(t){return 0===t?(s(),d("#Doc1",300),e.select("#Sign").selectAll("g").transition().duration(400).delay(function(t,e){return 300*(4-e)}).style("opacity",1)):1===t?(s(),c("#Doc1",800)):2===t?(s(),d("#Doc1",300),d("#Doc2",300),e.select("#Chemistry").selectAll("g").transition().duration(500).delay(function(t,e){return 300*e}).style("opacity",1)):3===t?(s(),d("#Time",300),c("#Doc2",800),e.select("#Doc2").selectAll("g").transition().duration(500).delay(function(t,e){return 300*e}).style("opacity",1)):4===t?(s(),d("#Doc2",300),c("#Time",800),e.select("#Time").selectAll("g").transition().duration(500).delay(function(t,e){return 300*e}).style("opacity",1)):5===t&&(s(),d("#Time",300),e.select("#World").transition().duration(800).style("opacity",1)),r=t,i};var s=function(){e.selectAll("#World, #Doc1, #Doc2").transition().duration(300).style("opacity",0),e.selectAll("#Chemistry, #Time, #Sign").selectAll("g").transition().duration(300).style("opacity",0)},c=function(t,a){var i=e.select(t).node().getBBox();e.select(t).attr("transform","translate("+(i.x+.5*i.width)+" "+(i.y+.5*i.height)+") scale(0.9) translate(-"+(i.x+.5*i.width)+" -"+(i.y+.5*i.height)+")").transition().duration(a).attr("transform","translate(0 0) scale(1)").style("opacity",1)},d=function(t,a){var i=e.select(t).node().getBBox();e.select(t).transition().duration(a).attr("transform","translate("+(i.x+.5*i.width)+" "+(i.y+.5*i.height)+") scale(0.9) translate(-"+(i.x+.5*i.width)+" -"+(i.y+.5*i.height)+")").style("opacity",0)};return i};!function(t){if(t('[data-toggle="tooltip"]').tooltip(),t(".dropdown-toggle").dropdown(),t("#region-dropdown-menu, #drug-dropdown-menu").click(function(t){t.stopPropagation()}),t("#prices-infographic").length>0){var e=new Infographic("#prices-infographic","prices");t(window).scroll(e.onScroll),t(window).resize(e.onResize)}else if(t("#counterfeits-infographic").length>0){var a=new Infographic("#counterfeits-infographic","fakes");t(window).scroll(a.onScroll),t(window).resize(a.onResize)}else if(t("#patents-graph").length>0){var i=patents_graph("#patents-graph").init();t(window).resize(i.onResize)}else if(t("#patents-infographic").length>0){var n=new Infographic("#patents-infographic","patentes"),r=new Infographic("#antimalaricos-infographic","antimalaricos");t(window).scroll(function(t){n.onScroll(),r.onScroll()}),t(window).resize(function(){n.onResize(),r.onResize()})}}(jQuery);