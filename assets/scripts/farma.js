(function(){var t=function(t,i){return function(){return t.apply(i,arguments)}};window.BaseGraph=function(){function i(i,n){return this.setYAxisPosition=t(this.setYAxisPosition,this),this.setXAxisPosition=t(this.setXAxisPosition,this),this.onResize=t(this.onResize,this),this.setupMarkerLabel=t(this.setupMarkerLabel,this),this.setupMarkerLine=t(this.setupMarkerLine,this),this.id=i,this.options=$.extend(!0,{},e,n),this.$el=$("#"+this.id),this.getDimensions(),this.setSVG(),this.setScales(),this.markers=[],this}var n,e;return e={margin:{top:0,right:0,bottom:20,left:0},aspectRatio:.5625,label:!1,legend:!1,mouseEvents:!0,key:{id:"key",x:"key",y:"value"}},n={value:null,label:"",orientation:"horizontal",align:"right"},i.prototype.setSVG=function(){return this.svg=d3.select("#"+this.id).append("svg").attr("width",this.containerWidth).attr("height",this.containerHeight),this.container=this.svg.append("g").attr("transform","translate("+this.options.margin.left+","+this.options.margin.top+")")},i.prototype.loadData=function(t){return d3.csv(t,function(t){return function(i,n){return t.$el.trigger("data-loaded"),t.setData(n)}}(this)),this},i.prototype.setData=function(t){return this.data=this.dataParser(t),this.drawScales(),this.options.legend&&this.drawLegend(),this.drawMarkers(),this.drawGraph(),this.$el.trigger("draw-complete"),this},i.prototype.dataParser=function(t){return t},i.prototype.setGraph=function(){return this},i.prototype.setScales=function(){return this},i.prototype.drawScales=function(){return this.x.domain(this.getScaleXDomain()),this.y.domain(this.getScaleYDomain()),this.xAxis&&this.container.append("g").attr("class","x axis").call(this.setXAxisPosition).call(this.xAxis),this.yAxis&&this.container.append("g").attr("class","y axis").call(this.setYAxisPosition).call(this.yAxis),this},i.prototype.getScaleXRange=function(){return[0,this.width]},i.prototype.getScaleYRange=function(){return[this.height,0]},i.prototype.getScaleXDomain=function(){return[]},i.prototype.getScaleYDomain=function(){return[]},i.prototype.drawLegend=function(){return this},i.prototype.addMarker=function(t){return this.markers.push($.extend({},n,t)),this},i.prototype.drawMarkers=function(){return this.container.selectAll(".marker").data(this.markers).enter().append("line").attr("class","marker").call(this.setupMarkerLine),this.container.selectAll(".marker-label").data(this.markers).enter().append("text").attr("class","marker-label").attr("text-anchor",function(t){return"vertical"===t.orientation?"middle":"right"===t.align?"end":"start"}).attr("dy",function(t){return"horizontal"===t.orientation?"-0.25em":0}).text(function(t){return t.label}).call(this.setupMarkerLabel)},i.prototype.setupMarkerLine=function(t){return t.attr("x1",function(t){return function(i){return"horizontal"===i.orientation?0:t.x(i.value)}}(this)).attr("y1",function(t){return function(i){return"horizontal"===i.orientation?t.y(i.value):0}}(this)).attr("x2",function(t){return function(i){return"horizontal"===i.orientation?t.width:t.x(i.value)}}(this)).attr("y2",function(t){return function(i){return"horizontal"===i.orientation?t.y(i.value):t.height}}(this))},i.prototype.setupMarkerLabel=function(t){return t.attr("x",function(t){return function(i){return"horizontal"===i.orientation?"right"===i.align?t.width:0:t.x(i.value)}}(this)).attr("y",function(t){return function(i){return"horizontal"===i.orientation?t.y(i.value):t.height}}(this))},i.prototype.onResize=function(){return this.getDimensions(),this.updateGraphDimensions(),this},i.prototype.getDimensions=function(){return this.$el&&(this.containerWidth=this.$el.width(),this.containerHeight=this.containerWidth*this.options.aspectRatio,this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},i.prototype.updateGraphDimensions=function(){return this.svg.attr("width",this.containerWidth).attr("height",this.containerHeight),this.x&&this.x.range(this.getScaleXRange()),this.y&&this.y.range(this.getScaleYRange()),this.xAxis&&this.container.selectAll(".x.axis").call(this.setXAxisPosition).call(this.xAxis),this.yAxis&&this.container.selectAll(".y.axis").call(this.setYAxisPosition).call(this.yAxis),this.container.select(".marker").call(this.setupMarkerLine),this.container.select(".marker-label").call(this.setupMarkerLabel),this},i.prototype.setXAxisPosition=function(t){return t.attr("transform","translate(0,"+this.height+")")},i.prototype.setYAxisPosition=function(t){return t.attr("transform","translate("+this.width+",0)")},i.prototype.getDataX=function(){return d[this.options.key.x]},i.prototype.getDataY=function(){return d[this.options.key.y]},i}()}).call(this),function(){var t=function(t,i){return function(){return t.apply(i,arguments)}},i=function(t,i){function e(){this.constructor=t}for(var o in i)n.call(i,o)&&(t[o]=i[o]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t},n={}.hasOwnProperty;window.BarGraph=function(n){function e(i,n){return this.onMouseOut=t(this.onMouseOut,this),this.onMouseOver=t(this.onMouseOver,this),this.setBarLabelYDimensions=t(this.setBarLabelYDimensions,this),this.setBarLabelXDimensions=t(this.setBarLabelXDimensions,this),this.setBarDimensions=t(this.setBarDimensions,this),this.getScaleYDomain=t(this.getScaleYDomain,this),this.getScaleXDomain=t(this.getScaleXDomain,this),e.__super__.constructor.call(this,i,n),this}return i(e,n),e.prototype.dataParser=function(t){return t.forEach(function(t){return function(i){return i[t.options.key.y]=+i[t.options.key.y]}}(this)),t},e.prototype.setScales=function(){return this.x=d3.scaleBand().range(this.getScaleXRange()).paddingInner(.1).paddingOuter(0),this.y=d3.scaleLinear().range(this.getScaleYRange()),this},e.prototype.getScaleXDomain=function(){return this.data.map(function(t){return function(i){return i[t.options.key.x]}}(this))},e.prototype.getScaleYDomain=function(){return[0,d3.max(this.data,function(t){return function(i){return i[t.options.key.y]}}(this))]},e.prototype.drawGraph=function(){return this.container.selectAll(".bar").data(this.data).enter().append("rect").attr("class",function(t){return t.active?"bar active":"bar"}).attr("id",function(t){return function(i){return i[t.options.key.id]}}(this)).call(this.setBarDimensions),this.options.mouseEvents&&this.container.selectAll(".bar").on("mouseover",this.onMouseOver).on("mouseout",this.onMouseOut),this.options.label&&(this.container.selectAll(".bar-label-x").data(this.data).enter().append("text").attr("class",function(t){return t.active?"bar-label-x active":"bar-label-x"}).attr("id",function(t){return function(i){return"bar-label-x-"+i[t.options.key.id]}}(this)).attr("dy","1.25em").attr("text-anchor","middle").text(function(t){return function(i){return i[t.options.key.x]}}(this)).call(this.setBarLabelXDimensions),this.container.selectAll(".bar-label-y").data(this.data).enter().append("text").attr("class",function(t){return t.active?"bar-label-y active":"bar-label-y"}).attr("id",function(t){return function(i){return"bar-label-y-"+i[t.options.key.id]}}(this)).attr("dy","-0.5em").attr("text-anchor","middle").text(function(t){return function(i){return t.options.label.format?t.options.label.format(i[t.options.key.y]):i[t.options.key.y]}}(this)).call(this.setBarLabelYDimensions)),this},e.prototype.updateGraphDimensions=function(){return e.__super__.updateGraphDimensions.call(this),this.container.selectAll(".bar").call(this.setBarDimensions),this.container.selectAll(".bar-label-x").call(this.setBarLabelXDimensions),this.container.selectAll(".bar-label-y").call(this.setBarLabelYDimensions),this},e.prototype.setBarDimensions=function(t){return t.attr("x",function(t){return function(i){return t.x(i[t.options.key.x])}}(this)).attr("y",function(t){return function(i){return t.y(i[t.options.key.y])}}(this)).attr("height",function(t){return function(i){return t.height-t.y(i[t.options.key.y])}}(this)).attr("width",this.x.bandwidth())},e.prototype.setBarLabelXDimensions=function(t){return t.attr("x",function(t){return function(i){return t.x(i[t.options.key.x])+.5*t.x.bandwidth()}}(this)).attr("y",function(t){return function(i){return t.height}}(this))},e.prototype.setBarLabelYDimensions=function(t){return t.attr("x",function(t){return function(i){return t.x(i[t.options.key.x])+.5*t.x.bandwidth()}}(this)).attr("y",function(t){return function(i){return t.y(i[t.options.key.y])}}(this))},e.prototype.onMouseOver=function(t){return this.container.select("#bar-label-x-"+t[this.options.key.id]).classed("active",!0),this.container.select("#bar-label-y-"+t[this.options.key.id]).classed("active",!0)},e.prototype.onMouseOut=function(t){if(!t.active)return this.container.select("#bar-label-x-"+t[this.options.key.id]).classed("active",!1),this.container.select("#bar-label-y-"+t[this.options.key.id]).classed("active",!1)},e}(window.BaseGraph)}.call(this),function(){var t=function(t,i){return function(){return t.apply(i,arguments)}};window.BarHorizontalPharmaGraph=function(){function i(i,n){return this.setBars=t(this.setBars,this),this.id=i,this.setData(n),this.drawGraph(),this}return i.prototype.setData=function(t){var i,n;return this.data=this.dataParser(t),i=d3.max(this.data,function(t){return t.declared}),n=d3.max(this.data,function(t){return t.hidden}),this.maxValue=d3.max([i,n]),this},i.prototype.dataParser=function(t){return t.forEach(function(t){return function(t){return t.hidden=+t.hidden,t.declared=+t.declared}}()),t},i.prototype.drawGraph=function(){return d3.select("#"+this.id).selectAll("div").data(this.data).enter().append("div").call(this.setBars),this},i.prototype.setBars=function(t){return t.append("div").attr("class","bar-title").html(function(t){return t.category}),t.append("div").attr("class","bar bar-declared").style("width",function(t){return function(i){return 100*i.declared/t.maxValue+"%"}}(this)).append("span").html(function(t){return t.declared.toFixed(1)+" €"}),t.append("div").attr("class","bar bar-hidden").style("width",function(t){return function(i){return 100*i.hidden/t.maxValue+"%"}}(this)).append("span").html(function(t){return t.hidden.toFixed(1)+" €"})},i}()}.call(this),function(){var t=function(t,i){return function(){return t.apply(i,arguments)}},i=function(t,i){function e(){this.constructor=t}for(var o in i)n.call(i,o)&&(t[o]=i[o]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t},n={}.hasOwnProperty;window.IcebergGraph=function(n){function e(i,n){return this.setTooltipData=t(this.setTooltipData,this),this.onMouseOut=t(this.onMouseOut,this),this.onMouseMove=t(this.onMouseMove,this),this.onMouseOver=t(this.onMouseOver,this),this.setMiddleLinePosition=t(this.setMiddleLinePosition,this),this.setBarLabelYDimensions=t(this.setBarLabelYDimensions,this),this.setBarLabelXDimensions=t(this.setBarLabelXDimensions,this),this.setBarDownDimensions=t(this.setBarDownDimensions,this),this.setBarUpDimensions=t(this.setBarUpDimensions,this),this.setBarDimensions=t(this.setBarDimensions,this),this.getScaleYDomain=t(this.getScaleYDomain,this),e.__super__.constructor.call(this,i,n),this}return i(e,n),e.prototype.setSVG=function(){return e.__super__.setSVG.call(this),this.$tooltip=this.$el.find(".tooltip")},e.prototype.dataParser=function(t){return t.forEach(function(t){return function(i){return i[t.options.key.up]=+i[t.options.key.up],i[t.options.key.down]=+i[t.options.key.down],i.total=i[t.options.key.up]+i[t.options.key.down]}}(this)),t},e.prototype.getScaleYRange=function(){return[0,this.height]},e.prototype.getScaleYDomain=function(){return[0,d3.max(this.data,function(t){return function(t){return t.total}}())]},e.prototype.drawGraph=function(){return this.upMax=d3.max(this.data,function(t){return function(i){return i[t.options.key.up]}}(this)),this.container.append("g").attr("class","bars-up"),this.container.append("g").attr("class","bars-down"),this.container.select(".bars-up").selectAll(".bar").data(this.data).enter().append("rect").attr("class",function(t){return t.active?"bar bar-up active":"bar bar-up"}).call(this.setBarUpDimensions),this.container.select(".bars-down").selectAll(".bar").data(this.data).enter().append("rect").attr("class",function(t){return t.active?"bar bar-down active":"bar bar-down"}).call(this.setBarDownDimensions),this.$tooltip&&this.container.selectAll(".bar").on("mouseover",this.onMouseOver).on("mousemove",this.onMouseMove).on("mouseout",this.onMouseOut),this.options.label&&(this.container.selectAll(".bar-label-x").data(this.data).enter().append("text").attr("class",function(t){return t.active?"bar-label-x active":"bar-label-x"}).attr("dy","-0.5em").text(function(t){return function(i){return i[t.options.key.x]}}(this)).call(this.setBarLabelXDimensions),this.container.selectAll(".bar-label-y").data(this.options.label.y).enter().append("text").attr("class","bar-label-y").attr("id",function(t,i){return 0===i?"bar-label-y-up":"bar-label-y-down"}).attr("dy",function(t,i){return 0===i?"-.5em":"1.25em"}).attr("x",-this.options.margin.left).text(function(t){return function(t){return t}}()).call(this.setBarLabelYDimensions),this.container.append("rect").attr("class","middle-line").attr("x",-this.options.margin.left).attr("y",function(t){return function(i){return t.y(t.upMax)}}(this)).attr("height",1).call(this.setMiddleLinePosition)),this},e.prototype.updateGraphDimensions=function(){return e.__super__.updateGraphDimensions.call(this),this.container.selectAll(".bar-up").call(this.setBarUpDimensions),this.container.selectAll(".bar-down").call(this.setBarDownDimensions),this.options.label&&this.container.select(".middle-line").call(this.setMiddleLinePosition),this},e.prototype.setBarDimensions=function(t){},e.prototype.setBarUpDimensions=function(t){return t.attr("x",function(t){return function(i){return t.x(i[t.options.key.x])}}(this)).attr("y",function(t){return function(i){return t.y(t.upMax-i[t.options.key.up])}}(this)).attr("height",function(t){return function(i){return t.y(i[t.options.key.up])}}(this)).attr("width",this.x.bandwidth())},e.prototype.setBarDownDimensions=function(t){return t.attr("x",function(t){return function(i){return t.x(i[t.options.key.x])}}(this)).attr("y",function(t){return function(i){return t.y(t.upMax)}}(this)).attr("height",function(t){return function(i){return t.y(i[t.options.key.down])}}(this)).attr("width",this.x.bandwidth())},e.prototype.setBarLabelXDimensions=function(t){return t.attr("x",function(t){return function(i){return t.x(i[t.options.key.x])+.5*t.x.bandwidth()}}(this)).attr("y",function(t){return function(i){return t.y(t.upMax-i[t.options.key.up])}}(this))},e.prototype.setBarLabelYDimensions=function(t){return t.attr("y",function(t){return function(i){return t.y(t.upMax)}}(this))},e.prototype.setMiddleLinePosition=function(t){return t.attr("y",function(t){return function(i){return t.y(t.upMax)}}(this)).attr("width",this.width+this.options.margin.left+this.options.margin.right)},e.prototype.onMouseOver=function(t){return this.setTooltipData(t),this.onMouseMove(t),this.$tooltip.css("opacity",1)},e.prototype.onMouseMove=function(t){var i;return i=d3.mouse(d3.event.target),this.$tooltip.css({left:this.$el.offset().left+i[0]+this.options.margin.left-.5*this.$tooltip.width(),top:this.$el.offset().top+i[1]-this.$tooltip.height()})},e.prototype.onMouseOut=function(t){return this.$tooltip.css("opacity",0)},e.prototype.setTooltipData=function(t){return this.$tooltip.find(".tooltip-inner .title").html(t.category),this.$tooltip.find(".tooltip-inner .declared").html((1e-6*t.declared).toFixed(1)),this.$tooltip.find(".tooltip-inner .hidden").html((1e-6*t.hidden).toFixed(1))},e}(window.BarGraph)}.call(this),function(){var t=function(t,i){return function(){return t.apply(i,arguments)}},i=function(t,i){function e(){this.constructor=t}for(var o in i)n.call(i,o)&&(t[o]=i[o]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t},n={}.hasOwnProperty;window.BeeswarmGraph=function(n){function e(i,n){return this.setTooltipData=t(this.setTooltipData,this),this.onMouseOut=t(this.onMouseOut,this),this.onMouseOver=t(this.onMouseOver,this),this.setXAxisPosition=t(this.setXAxisPosition,this),this.getColorDomain=t(this.getColorDomain,this),this.getSizeDomain=t(this.getSizeDomain,this),this.getSizeRange=t(this.getSizeRange,this),this.getScaleXDomain=t(this.getScaleXDomain,this),this.setCell=t(this.setCell,this),n.dotSize=n.dotSize||5,n.dotMinSize=n.dotMinSize||2,n.dotMaxSize=n.dotMaxSize||15,this.annotations=[],e.__super__.constructor.call(this,i,n),this}return i(e,n),e.prototype.drawGraph=function(){if(this.setSize(),this.setSimulation(),this.runSimulation(),this.voronoi=d3.voronoi().extent(this.getVoronoiExtent()).x(function(t){return t.x}).y(function(t){return t.y}),this.container.append("g").attr("class","cells"),this.drawCells(),this.annotations.length>0)return this.setAnnotations()},e.prototype.drawCells=function(){if(this.container.select(".cells").selectAll("g").data(this.voronoi.polygons(this.data)).enter().append("g").attr("class","cell").attr("id",function(t){return"cell-"+t.data.id}).call(this.setCell),this.$tooltip)return this.container.selectAll(".cell").select("path").on("mouseover",this.onMouseOver).on("mouseout",this.onMouseOut)},e.prototype.setCell=function(t){return t.append("circle").attr("r",function(t){return function(i){return t.size?i.data.radius:t.options.dotSize}}(this)).attr("fill",function(t){return function(i){return t.color(t.colorMap(i.data[t.options.key.color]))}}(this)).call(this.setCellPosition),t.append("path").call(this.setCellVoronoiPath)},e.prototype.setSimulation=function(){var t;return t=d3.forceX(function(t){return function(i){return t.x(i.value)}}(this)),t.strength(1),this.simulation=d3.forceSimulation(this.data).force("x",t).force("y",d3.forceY(.5*this.height)).force("collide",d3.forceCollide(function(t){return function(i){return t.size?i.radius+1:t.options.dotSize+1}}(this))).stop()},e.prototype.runSimulation=function(){var t,i;for(t=0,i=[];t<120;)this.simulation.tick(),i.push(++t);return i},e.prototype.getVoronoiExtent=function(){return[[-this.options.margin.left-1,-this.options.margin.top-1],[this.width+this.options.margin.right+1,this.height+this.options.margin.top+1]]},e.prototype.setCellPosition=function(t){return t.attr("cx",function(t){return t.data.x}).attr("cy",function(t){return t.data.y})},e.prototype.setCellVoronoiPath=function(t){return t.attr("d",function(t){return"M"+t.join("L")+"Z"})},e.prototype.setSize=function(){if(this.size)return this.data.forEach(function(t){return function(i){return i.radius=t.size(i[t.options.key.size])}}(this))},e.prototype.updateGraphDimensions=function(){return e.__super__.updateGraphDimensions.call(this),this.setSimulation(),this.runSimulation(),this.voronoi.extent(this.getVoronoiExtent()),this.container.selectAll(".cell").remove(),this.drawCells(),this.annotations.length>0&&this.setAnnotations(),this},e.prototype.drawLegend=function(){return d3.select(".pharma-transfers-container").select(".legend").selectAll("li").data([25,50,75,100]).enter().append("li").style("background",function(t){return function(i){return t.color(i)}}(this)).html(function(t){return t+"%"})},e.prototype.addAnnotation=function(t){return this.annotations.push(t)},e.prototype.setAnnotations=function(){var t;return this.annotations.forEach(function(t){return function(i){return i.cx=i.cx_ratio*t.width}}(this)),t=d3.ringNote(),this.container.call(t,this.annotations)},e.prototype.setScales=function(){return this.x=d3.scaleLinear().range(this.getScaleXRange()),this.options.key.size&&(this.size=d3.scalePow().exponent(.5).range(this.getSizeRange())),this.options.key.color&&(this.colorMap=d3.scaleQuantize().domain([0,100]).range([25,50,75,100]),this.color=d3.scaleSequential(d3.interpolateRdYlGn)),this.xAxis=d3.axisBottom(this.x).tickSize(0).tickValues([]),this},e.prototype.getScaleXDomain=function(){return[0,100]},e.prototype.getSizeRange=function(){return[this.options.dotMinSize,this.options.dotMaxSize]},e.prototype.getSizeDomain=function(){return[0,d3.max(this.data,function(t){return function(i){return i[t.options.key.size]}}(this))]},e.prototype.getColorDomain=function(){return[100,0]},e.prototype.setXAxisPosition=function(t){return t.attr("transform","translate(0,"+.5*this.height+")")},e.prototype.drawScales=function(){return this.x.domain(this.getScaleXDomain()),this.size&&this.size.domain(this.getSizeDomain()),this.color&&this.color.domain(this.getColorDomain()),this.xAxis&&this.container.append("g").attr("class","x axis").call(this.setXAxisPosition).call(this.xAxis),this},e.prototype.getDimensions=function(){return this.$el&&(this.containerWidth=this.$el.width(),this.containerHeight=140,this.width=this.containerWidth-this.options.margin.left-this.options.margin.right,this.height=this.containerHeight-this.options.margin.top-this.options.margin.bottom),this},e.prototype.onMouseOver=function(t){var i;return i=d3.select(d3.event.target.parentNode).select("circle"),this.setTooltipData(t),this.$tooltip.css({left:+i.attr("cx")+this.options.margin.left+this.$el.offset().left-.5*this.$tooltip.width(),top:+i.attr("cy")+this.options.margin.top+this.$el.offset().top-this.$tooltip.height()-i.attr("r")-5,opacity:1})},e.prototype.onMouseOut=function(t){return this.$tooltip.css("opacity","0")},e.prototype.setTooltipData=function(t){return this.$tooltip.find(".tooltip-inner .title").html(t.data[this.options.key.id]),this.$tooltip.find(".tooltip-inner .value").html(Math.round(t.data.value)+"%"),this.$tooltip.find(".tooltip-inner .total").html(t.data.size),t.data.subsidiaries?(this.$tooltip.find(".tooltip-inner .subsidiaries").html(t.data.subsidiaries),this.$tooltip.find(".tooltip-inner .subsidiaries-cont").show()):this.$tooltip.find(".tooltip-inner .subsidiaries-cont").hide()},e}(window.BaseGraph)}.call(this),function(){!function(t){var i;if(t("body").data("lang"),i=t("body").data("baseurl"),t("#pharma-categories-amounts").length>0&&d3.csv(i+"/data/pharma-categories-amounts.csv",function(i,n){var e;return e=new window.IcebergGraph("pharma-categories-amounts",{aspectRatio:.6,margin:{top:20,bottom:0,left:100,right:20},label:{y:["Declarado","Oculto"]},key:{x:"category",up:"declared",down:"hidden"}}),e.setData(n),t(window).resize(e.onResize)}),t("#pharma-doctors-average").length>0&&d3.csv(i+"/data/pharma-doctors-average.csv",function(t,i){return new window.BarHorizontalPharmaGraph("pharma-doctors-average",i)}),t(".pharma-transfers").length>0)d3.csv(i+"/data/pharma-transfers.csv",function(i,n){var e,o,r,s;return o=["charges","travels","fees","relateds"],e={travels:{cx_ratio:.88,cy:70,r:80,textWidth:220,textOffset:[-85,-80],text:"Las principales firmas se encuentran en la zona de mayor opacidad"},fees:{cx_ratio:.032,cy:70,r:22,textWidth:200,textOffset:[60,55],text:"GSK es el laboratorio que más nombres de médicos publica"}},r=[],o.forEach(function(t){return r.push(d3.max(n,function(i){return+i[t+"_doctors_total"]}))}),s=d3.max(r),n.forEach(function(i,n){return i.id=n,t("#pharma-selector select").append('<option value="'+i.id+'">'+i.laboratory+"</option>")}),o.forEach(function(i,o){var r,a;return r=n.filter(function(t){return""!==t[i+"_doctors_percent"]&&""!==t[i+"_doctors_total"]}).map(function(t){return{id:t.id,laboratory:t.laboratory,subsidiaries:t.subsidiaries,value:100*t[i+"_doctors_percent"],size:+t[i+"_doctors_total"],import:Math.round(+t[i+"_value"])}}),a=new window.BeeswarmGraph("pharma-transfers-"+i,{margin:{top:0,bottom:0,left:0,right:20},key:{id:"laboratory",size:"size",color:"value"},legend:0===o}),a.$tooltip=t("#pharma-transfers-tooltip"),a.getSizeDomain=function(){return[0,s]},e[i]&&a.addAnnotation(e[i]),a.setData(r),t(window).resize(a.onResize)}),t("#pharma-selector select").change(function(i){var n;return n=t(i.target).val(),"-1"===n?o.forEach(function(i){return t("#pharma-transfers-"+i+" .cell").removeClass("desactive").removeClass("active")}):o.forEach(function(i){return t("#pharma-transfers-"+i+" .cell").removeClass("active").addClass("desactive"),t("#pharma-transfers-"+i+" #cell-"+n).removeClass("desactive").addClass("active")})})})}(jQuery)}.call(this);